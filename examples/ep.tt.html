<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<title>Erasure explorer</title>
</head>

<style>

body {
    font-family: sans-serif;
}

.rel {
    color: #480;
}

.op {
    color: #800;
}

.def {
    margin-bottom: 10px;
}

.lambda > .head {
    margin-right: 10px;
}

a {
    text-decoration: none;
}

a:hover {
    background-color: yellow;
}

.ap {
    color: #ccc;
    font-size: 0.75em;
}

.erased {
    /* background-color: #e8e8e8; */
    text-decoration: line-through;
    -moz-text-decoration-color: red;
}

.paren {
    color: #aaa;
}

.marked {
    background: #e8e8e8;
}

.marked-num {
    background: yellow;
    color: red;
}

.shown {
    /* display: block !important; */
    color: red;
    background: yellow;
}

.constr {
    /* display: none; */
}

.app {
}

</style>

<script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
<script>

function cleanup() {
    $('.marked').removeClass('marked');
    $('.marked-num').removeClass('marked-num');
    $('.shown').removeClass('shown');
}

function init() {
    $('.mvar').each(function() {
        var elm = $(this);
        var mvar = elm.attr('class').match(/mvar-(\d+)/)[1];
        elm.mouseover(function(event) {
            cleanup();
            for (var i = 0; i < constrs.length; ++i) {
                if ($.inArray(mvar, constrs[i][1]) != -1) {
                    $('.constr-' + i).addClass('shown');
                    var gs = constrs[i][0];
                    for (var j = 0; j < gs.length; ++j) {
                        $('.def .mvar-' + gs[j]).addClass('marked');
                        $('.def .mvar-num-' + gs[j]).addClass('marked-num');
                    }
                }
            }
            event.stopPropagation();
            return false;
        });
    });
}

$(init);
</script>

<body>

<h1>Erasure explorer</h1>
<p>Put your mouse cursor over any variable to highlight which variables may cause its usage.
Erased things are <span class="nrty-E">grayed out</span>.</p>
<h2>Metaified program</h2>
<div class="def axiom">
<div class="type">
<span class="erased "><span class="name name-T">T</span><span class="rel rel-E"> :<sub>E</sub> </span><span class="star">*</span>
</span>
</div>

</div>
<div class="def axiom">
<div class="type">
<span class="not-erased "><span class="name name-A">A</span><span class="rel rel-R"> :<sub>R</sub> </span><span class="var"><span class="name name-T">T</span></span>
</span>
</div>

</div>
<div class="def axiom">
<div class="type">
<span class="not-erased "><span class="name name-B">B</span><span class="rel rel-R"> :<sub>R</sub> </span><span class="var"><span class="name name-T">T</span></span>
</span>
</div>

</div>
<div class="def axiom">
<div class="type">
<span class="not-erased "><span class="name name-Op">Op</span><span class="rel rel-R"> :<sub>R</sub> </span><span class="pi"><span class="paren">(</span><span class="not-erased "><span class="name name-x">x</span><span class="rel rel-R"> :<sub>R</sub> </span><span class="var"><span class="name name-T">T</span></span>
</span><span class="paren">)</span><span class="op"> &#8594; </span><span class="pi"><span class="paren">(</span><span class="not-erased "><span class="name name-y">y</span><span class="rel rel-R"> :<sub>R</sub> </span><span class="var"><span class="name name-T">T</span></span>
</span><span class="paren">)</span><span class="op"> &#8594; </span><span class="var"><span class="name name-T">T</span></span></span></span>
</span>
</div>

</div>
<div class="def function">
<div class="type">
<span class="not-erased "><span class="name name-id">id</span><span class="rel rel-R"> :<sub>R</sub> </span><span class="pi"><span class="paren">(</span><span class="not-erased "><span class="name name-_">_</span><span class="rel rel-R"> :<sub>R</sub> </span><span class="var"><span class="name name-T">T</span></span>
</span><span class="paren">)</span><span class="op"> &#8594; </span><span class="var"><span class="name name-T">T</span></span></span>
</span>
</div>
<div class="definition">
<span class="name name-id">id</span><span class="op"> = </span><span class="lambda"><span class="head"><span class="op">&lambda; </span><span class="not-erased "><span class="name name-y">y</span><span class="rel rel-R"> :<sub>R</sub> </span><span class="var"><span class="name name-T">T</span></span>
</span><span class="op">.</span></span><span class="var"><span class="name name-y">y</span></span></span>
</div>

</div>
<div class="def function">
<div class="type">
<span class="not-erased "><span class="name name-constA">constA</span><span class="rel rel-R"> :<sub>R</sub> </span><span class="pi"><span class="paren">(</span><span class="erased "><span class="name name-_">_</span><span class="rel rel-E"> :<sub>E</sub> </span><span class="var"><span class="name name-T">T</span></span>
</span><span class="paren">)</span><span class="op"> &#8594; </span><span class="var"><span class="name name-T">T</span></span></span>
</span>
</div>
<div class="definition">
<span class="name name-constA">constA</span><span class="op"> = </span><span class="lambda"><span class="head"><span class="op">&lambda; </span><span class="erased "><span class="name name-_">_</span><span class="rel rel-E"> :<sub>E</sub> </span><span class="var"><span class="name name-T">T</span></span>
</span><span class="op">.</span></span><span class="var"><span class="name name-A">A</span></span></span>
</div>

</div>
<div class="def function">
<div class="type">
<span class="erased "><span class="name name-apply">apply</span><span class="rel rel-E"> :<sub>E</sub> </span><span class="pi"><span class="paren">(</span><span class="not-erased "><span class="name name-f">f</span><span class="rel rel-R"> :<sub>R</sub> </span><span class="pi"><span class="paren">(</span><span class="erased "><span class="name name-_">_</span><span class="rel rel-E"> :<sub>E</sub> </span><span class="var"><span class="name name-T">T</span></span>
</span><span class="paren">)</span><span class="op"> &#8594; </span><span class="var"><span class="name name-T">T</span></span></span>
</span><span class="paren">)</span><span class="op"> &#8594; </span><span class="pi"><span class="paren">(</span><span class="erased "><span class="name name-_">_</span><span class="rel rel-E"> :<sub>E</sub> </span><span class="var"><span class="name name-T">T</span></span>
</span><span class="paren">)</span><span class="op"> &#8594; </span><span class="var"><span class="name name-T">T</span></span></span></span>
</span>
</div>
<div class="definition">
<span class="name name-apply">apply</span><span class="op"> = </span><span class="lambda"><span class="head"><span class="op">&lambda; </span><span class="not-erased "><span class="name name-f">f</span><span class="rel rel-R"> :<sub>R</sub> </span><span class="pi"><span class="paren">(</span><span class="erased "><span class="name name-_">_</span><span class="rel rel-E"> :<sub>E</sub> </span><span class="var"><span class="name name-T">T</span></span>
</span><span class="paren">)</span><span class="op"> &#8594; </span><span class="var"><span class="name name-T">T</span></span></span>
</span><span class="op">.</span></span><span class="lambda"><span class="head"><span class="op">&lambda; </span><span class="erased "><span class="name name-x">x</span><span class="rel rel-E"> :<sub>E</sub> </span><span class="var"><span class="name name-T">T</span></span>
</span><span class="op">.</span></span><span class="app"><span class="paren">(</span><span class="var"><span class="name name-f">f</span></span><span class="ap ap-E">E</span><span class="erased "><span class="var"><span class="name name-x">x</span></span></span><span class="paren">)</span></span></span></span>
</div>

</div>
<div class="def function">
<div class="type">
<span class="not-erased mvar mvar-1"><span class="name name-apply_REE">apply_REE</span><span class="rel mvar-num-1"> :<sub>1</sub> </span><span class="pi"><span class="paren">(</span><span class="not-erased "><span class="name name-f">f</span><span class="rel rel-R"> :<sub>R</sub> </span><span class="pi"><span class="paren">(</span><span class="erased "><span class="name name-_">_</span><span class="rel rel-E"> :<sub>E</sub> </span><span class="var"><span class="name name-T">T</span></span>
</span><span class="paren">)</span><span class="op"> &#8594; </span><span class="var"><span class="name name-T">T</span></span></span>
</span><span class="paren">)</span><span class="op"> &#8594; </span><span class="pi"><span class="paren">(</span><span class="erased "><span class="name name-_">_</span><span class="rel rel-E"> :<sub>E</sub> </span><span class="var"><span class="name name-T">T</span></span>
</span><span class="paren">)</span><span class="op"> &#8594; </span><span class="var"><span class="name name-T">T</span></span></span></span>
</span>
</div>
<div class="definition">
<span class="name name-apply_REE">apply_REE</span><span class="op"> = </span><span class="lambda"><span class="head"><span class="op">&lambda; </span><span class="not-erased mvar mvar-2"><span class="name name-f">f</span><span class="rel mvar-num-2"> :<sub>2</sub> </span><span class="pi"><span class="paren">(</span><span class="erased mvar mvar-3"><span class="name name-_">_</span><span class="rel mvar-num-3"> :<sub>3</sub> </span><span class="var"><span class="name name-T">T</span></span>
</span><span class="paren">)</span><span class="op"> &#8594; </span><span class="var"><span class="name name-T">T</span></span></span>
</span><span class="op">.</span></span><span class="lambda"><span class="head"><span class="op">&lambda; </span><span class="erased mvar mvar-4"><span class="name name-x">x</span><span class="rel mvar-num-4"> :<sub>4</sub> </span><span class="var"><span class="name name-T">T</span></span>
</span><span class="op">.</span></span><span class="app"><span class="paren">(</span><span class="var"><span class="name name-f">f</span></span><span class="ap mvar-num-5">5</span><span class="erased mvar mvar-5"><span class="var"><span class="name name-x">x</span></span></span><span class="paren">)</span></span></span></span>
</div>

</div>
<div class="def function">
<div class="type">
<span class="not-erased mvar mvar-6"><span class="name name-apply_RRR">apply_RRR</span><span class="rel mvar-num-6"> :<sub>6</sub> </span><span class="pi"><span class="paren">(</span><span class="not-erased "><span class="name name-f">f</span><span class="rel rel-R"> :<sub>R</sub> </span><span class="pi"><span class="paren">(</span><span class="not-erased "><span class="name name-_">_</span><span class="rel rel-R"> :<sub>R</sub> </span><span class="var"><span class="name name-T">T</span></span>
</span><span class="paren">)</span><span class="op"> &#8594; </span><span class="var"><span class="name name-T">T</span></span></span>
</span><span class="paren">)</span><span class="op"> &#8594; </span><span class="pi"><span class="paren">(</span><span class="not-erased "><span class="name name-_">_</span><span class="rel rel-R"> :<sub>R</sub> </span><span class="var"><span class="name name-T">T</span></span>
</span><span class="paren">)</span><span class="op"> &#8594; </span><span class="var"><span class="name name-T">T</span></span></span></span>
</span>
</div>
<div class="definition">
<span class="name name-apply_RRR">apply_RRR</span><span class="op"> = </span><span class="lambda"><span class="head"><span class="op">&lambda; </span><span class="not-erased mvar mvar-7"><span class="name name-f">f</span><span class="rel mvar-num-7"> :<sub>7</sub> </span><span class="pi"><span class="paren">(</span><span class="not-erased mvar mvar-8"><span class="name name-_">_</span><span class="rel mvar-num-8"> :<sub>8</sub> </span><span class="var"><span class="name name-T">T</span></span>
</span><span class="paren">)</span><span class="op"> &#8594; </span><span class="var"><span class="name name-T">T</span></span></span>
</span><span class="op">.</span></span><span class="lambda"><span class="head"><span class="op">&lambda; </span><span class="not-erased mvar mvar-9"><span class="name name-x">x</span><span class="rel mvar-num-9"> :<sub>9</sub> </span><span class="var"><span class="name name-T">T</span></span>
</span><span class="op">.</span></span><span class="app"><span class="paren">(</span><span class="var"><span class="name name-f">f</span></span><span class="ap mvar-num-10">10</span><span class="not-erased mvar mvar-10"><span class="var"><span class="name name-x">x</span></span></span><span class="paren">)</span></span></span></span>
</div>

</div>
<div class="def function">
<div class="type">
<span class="not-erased "><span class="name name-test1">test1</span><span class="rel rel-R"> :<sub>R</sub> </span><span class="var"><span class="name name-T">T</span></span>
</span>
</div>
<div class="definition">
<span class="name name-test1">test1</span><span class="op"> = </span><span class="app"><span class="paren">(</span><span class="app"><span class="paren">(</span><span class="var"><span class="name name-apply_RRR">apply_RRR</span></span><span class="ap ap-R">R</span><span class="not-erased "><span class="var"><span class="name name-id">id</span></span></span><span class="paren">)</span></span><span class="ap ap-R">R</span><span class="not-erased "><span class="var"><span class="name name-B">B</span></span></span><span class="paren">)</span></span>
</div>

</div>
<div class="def function">
<div class="type">
<span class="not-erased "><span class="name name-test2">test2</span><span class="rel rel-R"> :<sub>R</sub> </span><span class="var"><span class="name name-T">T</span></span>
</span>
</div>
<div class="definition">
<span class="name name-test2">test2</span><span class="op"> = </span><span class="app"><span class="paren">(</span><span class="app"><span class="paren">(</span><span class="var"><span class="name name-apply_REE">apply_REE</span></span><span class="ap ap-R">R</span><span class="not-erased "><span class="var"><span class="name name-constA">constA</span></span></span><span class="paren">)</span></span><span class="ap ap-E">E</span><span class="erased "><span class="var"><span class="name name-B">B</span></span></span><span class="paren">)</span></span>
</div>

</div>
<div class="def function">
<div class="type">
<span class="not-erased "><span class="name name-main">main</span><span class="rel rel-R"> :<sub>R</sub> </span><span class="var"><span class="name name-T">T</span></span>
</span>
</div>
<div class="definition">
<span class="name name-main">main</span><span class="op"> = </span><span class="app"><span class="paren">(</span><span class="app"><span class="paren">(</span><span class="var"><span class="name name-Op">Op</span></span><span class="ap ap-R">R</span><span class="not-erased "><span class="var"><span class="name name-test1">test1</span></span></span><span class="paren">)</span></span><span class="ap ap-R">R</span><span class="not-erased "><span class="var"><span class="name name-test2">test2</span></span></span><span class="paren">)</span></span>
</div>

</div>

<h2>Constraints</h2>
<div class="constraints">
<span class="constr constr-0"><span class="uses"><span class="op">{</span><span class="op">}</span></span><span class="op"> &#8594; </span><span class="guards"><span class="op">{</span><span class="meta mvar mvar-1">1</span><span class="op">, </span><span class="meta mvar mvar-2">2</span><span class="op">, </span><span class="meta mvar mvar-6">6</span><span class="op">, </span><span class="meta mvar mvar-7">7</span><span class="op">, </span><span class="meta mvar mvar-8">8</span><span class="op">, </span><span class="meta mvar mvar-9">9</span><span class="op">, </span><span class="meta mvar mvar-10">10</span><span class="op">, </span><span class="meta-R">R</span><span class="op">}</span></span></span>, <span class="constr constr-1"><span class="uses"><span class="op">{</span><span class="meta mvar mvar-3">3</span><span class="op">}</span></span><span class="op"> &#8594; </span><span class="guards"><span class="op">{</span><span class="meta mvar mvar-4">4</span><span class="op">, </span><span class="meta mvar mvar-5">5</span><span class="op">, </span><span class="meta-E">E</span><span class="op">}</span></span></span>, <span class="constr constr-2"><span class="uses"><span class="op">{</span><span class="meta mvar mvar-4">4</span><span class="op">}</span></span><span class="op"> &#8594; </span><span class="guards"><span class="op">{</span><span class="meta-E">E</span><span class="op">}</span></span></span>, <span class="constr constr-3"><span class="uses"><span class="op">{</span><span class="meta mvar mvar-5">5</span><span class="op">}</span></span><span class="op"> &#8594; </span><span class="guards"><span class="op">{</span><span class="meta mvar mvar-3">3</span><span class="op">}</span></span></span>, <span class="constr constr-4"><span class="uses"><span class="op">{</span><span class="meta-E">E</span><span class="op">}</span></span><span class="op"> &#8594; </span><span class="guards"><span class="op">{</span><span class="meta mvar mvar-3">3</span><span class="op">, </span><span class="meta mvar mvar-4">4</span><span class="op">, </span><span class="meta-E">E</span><span class="op">}</span></span></span>, 
</div>

<script>var constrs=[
[[],["1","2","6","7","8","9","10","R"]],
[["3"],["4","5","E"]],
[["4"],["E"]],
[["5"],["3"]],
[["E"],["3","4","E"]],

[]];</script></body></html>
