<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<title>Erasure explorer</title>
</head>

<style>

body {
    font-family: sans-serif;
}

.rel {
    color: #480;
}

.op {
    color: #800;
}

.def {
    margin-bottom: 10px;
}

.lambda > .head {
    margin-right: 10px;
}

a {
    text-decoration: none;
}

a:hover {
    background-color: yellow;
}

.ap {
    color: #ccc;
    font-size: 0.75em;
}

.erased {
    /* background-color: #e8e8e8; */
    text-decoration: line-through;
    -moz-text-decoration-color: red;
}

.paren {
    color: #aaa;
}

.marked {
    background: #e8e8e8;
}

.marked-num {
    background: yellow;
    color: red;
}

.shown {
    /* display: block !important; */
    color: red;
    background: yellow;
}

.constr {
    /* display: none; */
}

.app {
}

</style>

<script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
<script>

function cleanup() {
    $('.marked').removeClass('marked');
    $('.marked-num').removeClass('marked-num');
    $('.shown').removeClass('shown');
}

function init() {
    $('.mvar').each(function() {
        var elm = $(this);
        var mvar = elm.attr('class').match(/mvar-(\d+)/)[1];
        elm.mouseover(function(event) {
            cleanup();
            for (var i = 0; i < constrs.length; ++i) {
                if ($.inArray(mvar, constrs[i][1]) != -1) {
                    $('.constr-' + i).addClass('shown');
                    var gs = constrs[i][0];
                    for (var j = 0; j < gs.length; ++j) {
                        $('.def .mvar-' + gs[j]).addClass('marked');
                        $('.def .mvar-num-' + gs[j]).addClass('marked-num');
                    }
                }
            }
            event.stopPropagation();
            return false;
        });
    });
}

$(init);
</script>

<body>

<h1>Erasure explorer</h1>
<p>Put your mouse cursor over any variable to highlight which variables may cause its usage.
Erased things are <span class="nrty-E">grayed out</span>.</p>
<h2>Metaified program</h2>
<ul class="defs" ><li class="" ><span class="not-erased mvar mvar-1" ><span class="name name-Bool" >Bool</span><span class="rel mvar-num-1" > :<sub>1</sub> </span><span class="var" ><span class="name name-Type" >Type</span></span>
</span></li>
<li class="" ><span class="not-erased mvar mvar-2" ><span class="name name-True" >True</span><span class="rel mvar-num-2" > :<sub>2</sub> </span><span class="var" ><span class="name name-Bool" >Bool</span></span>
</span></li>
<li class="" ><span class="not-erased mvar mvar-3" ><span class="name name-False" >False</span><span class="rel mvar-num-3" > :<sub>3</sub> </span><span class="var" ><span class="name name-Bool" >Bool</span></span>
</span></li>
<li class="" ><span class="erased mvar mvar-4" ><span class="name name-Nat" >Nat</span><span class="rel mvar-num-4" > :<sub>4</sub> </span><span class="var" ><span class="name name-Type" >Type</span></span>
</span></li>
<li class="" ><span class="not-erased mvar mvar-5" ><span class="name name-Z" >Z</span><span class="rel mvar-num-5" > :<sub>5</sub> </span><span class="var" ><span class="name name-Nat" >Nat</span></span>
</span></li>
<li class="" ><span class="not-erased mvar mvar-6" ><span class="name name-S" >S</span><span class="rel mvar-num-6" > :<sub>6</sub> </span><span class="pi" ><span class="paren" >(</span><span class="not-erased " ><span class="name name-n" >n</span><span class="rel rel-R" > :<sub>R</sub> </span><span class="var" ><span class="name name-Nat" >Nat</span></span>
</span><span class="paren" >)</span><span class="op" > &#8594; </span><span class="var" ><span class="name name-Nat" >Nat</span></span></span>
</span></li>
<li class="" ><span class="erased mvar mvar-7" ><span class="name name-Vec" >Vec</span><span class="rel mvar-num-7" > :<sub>7</sub> </span><span class="pi" ><span class="paren" >(</span><span class="erased mvar mvar-8" ><span class="name name-_" >_</span><span class="rel mvar-num-8" > :<sub>8</sub> </span><span class="var" ><span class="name name-Nat" >Nat</span></span>
</span><span class="paren" >)</span><span class="op" > &#8594; </span><span class="pi" ><span class="paren" >(</span><span class="erased mvar mvar-9" ><span class="name name-_" >_</span><span class="rel mvar-num-9" > :<sub>9</sub> </span><span class="var" ><span class="name name-Type" >Type</span></span>
</span><span class="paren" >)</span><span class="op" > &#8594; </span><span class="var" ><span class="name name-Type" >Type</span></span></span></span>
</span></li>
<li class="" ><span class="not-erased mvar mvar-10" ><span class="name name-VNil" >VNil</span><span class="rel mvar-num-10" > :<sub>10</sub> </span><span class="pi" ><span class="paren" >(</span><span class="not-erased mvar mvar-11" ><span class="name name-a" >a</span><span class="rel mvar-num-11" > :<sub>11</sub> </span><span class="var" ><span class="name name-Type" >Type</span></span>
</span><span class="paren" >)</span><span class="op" > &#8594; </span><span class="app" ><span class="paren" >(</span><span class="app" ><span class="paren" >(</span><span class="var" ><span class="name name-Vec" >Vec</span></span><span class="ap mvar-num-13" >13</span><span class="erased mvar mvar-13" ><span class="var" ><span class="name name-Z" >Z</span></span></span><span class="paren" >)</span></span><span class="ap mvar-num-12" >12</span><span class="erased mvar mvar-12" ><span class="var" ><span class="name name-a" >a</span></span></span><span class="paren" >)</span></span></span>
</span></li>
<li class="" ><span class="not-erased mvar mvar-14" ><span class="name name-VCons" >VCons</span><span class="rel mvar-num-14" > :<sub>14</sub> </span><span class="pi" ><span class="paren" >(</span><span class="not-erased mvar mvar-15" ><span class="name name-a" >a</span><span class="rel mvar-num-15" > :<sub>15</sub> </span><span class="var" ><span class="name name-Type" >Type</span></span>
</span><span class="paren" >)</span><span class="op" > &#8594; </span><span class="pi" ><span class="paren" >(</span><span class="not-erased mvar mvar-16" ><span class="name name-n" >n</span><span class="rel mvar-num-16" > :<sub>16</sub> </span><span class="var" ><span class="name name-Nat" >Nat</span></span>
</span><span class="paren" >)</span><span class="op" > &#8594; </span><span class="pi" ><span class="paren" >(</span><span class="not-erased mvar mvar-17" ><span class="name name-x" >x</span><span class="rel mvar-num-17" > :<sub>17</sub> </span><span class="var" ><span class="name name-a" >a</span></span>
</span><span class="paren" >)</span><span class="op" > &#8594; </span><span class="pi" ><span class="paren" >(</span><span class="not-erased mvar mvar-18" ><span class="name name-xs" >xs</span><span class="rel mvar-num-18" > :<sub>18</sub> </span><span class="app" ><span class="paren" >(</span><span class="app" ><span class="paren" >(</span><span class="var" ><span class="name name-Vec" >Vec</span></span><span class="ap mvar-num-20" >20</span><span class="erased mvar mvar-20" ><span class="var" ><span class="name name-n" >n</span></span></span><span class="paren" >)</span></span><span class="ap mvar-num-19" >19</span><span class="erased mvar mvar-19" ><span class="var" ><span class="name name-a" >a</span></span></span><span class="paren" >)</span></span>
</span><span class="paren" >)</span><span class="op" > &#8594; </span><span class="app" ><span class="paren" >(</span><span class="app" ><span class="paren" >(</span><span class="var" ><span class="name name-Vec" >Vec</span></span><span class="ap mvar-num-22" >22</span><span class="erased mvar mvar-22" ><span class="app" ><span class="paren" >(</span><span class="var" ><span class="name name-S" >S</span></span><span class="ap mvar-num-23" >23</span><span class="not-erased mvar mvar-23" ><span class="var" ><span class="name name-n" >n</span></span></span><span class="paren" >)</span></span></span><span class="paren" >)</span></span><span class="ap mvar-num-21" >21</span><span class="erased mvar mvar-21" ><span class="var" ><span class="name name-a" >a</span></span></span><span class="paren" >)</span></span></span></span></span></span>
</span></li>
<li class="" ><span class="not-erased mvar mvar-24" ><span class="name name-vlen" >vlen</span><span class="rel mvar-num-24" > :<sub>24</sub> </span><span class="pi" ><span class="paren" >(</span><span class="erased mvar mvar-25" ><span class="name name-a" >a</span><span class="rel mvar-num-25" > :<sub>25</sub> </span><span class="var" ><span class="name name-Type" >Type</span></span>
</span><span class="paren" >)</span><span class="op" > &#8594; </span><span class="pi" ><span class="paren" >(</span><span class="erased mvar mvar-26" ><span class="name name-n" >n</span><span class="rel mvar-num-26" > :<sub>26</sub> </span><span class="var" ><span class="name name-Nat" >Nat</span></span>
</span><span class="paren" >)</span><span class="op" > &#8594; </span><span class="pi" ><span class="paren" >(</span><span class="not-erased mvar mvar-27" ><span class="name name-xs" >xs</span><span class="rel mvar-num-27" > :<sub>27</sub> </span><span class="app" ><span class="paren" >(</span><span class="app" ><span class="paren" >(</span><span class="var" ><span class="name name-Vec" >Vec</span></span><span class="ap mvar-num-29" >29</span><span class="erased mvar mvar-29" ><span class="var" ><span class="name name-n" >n</span></span></span><span class="paren" >)</span></span><span class="ap mvar-num-28" >28</span><span class="erased mvar mvar-28" ><span class="var" ><span class="name name-a" >a</span></span></span><span class="paren" >)</span></span>
</span><span class="paren" >)</span><span class="op" > &#8594; </span><span class="var" ><span class="name name-Nat" >Nat</span></span></span></span></span>
</span></li>
<li class="" ><span class="not-erased mvar mvar-48" ><span class="name name-testVec" >testVec</span><span class="rel mvar-num-48" > :<sub>48</sub> </span><span class="app" ><span class="paren" >(</span><span class="app" ><span class="paren" >(</span><span class="var" ><span class="name name-Vec" >Vec</span></span><span class="ap mvar-num-50" >50</span><span class="erased mvar mvar-50" ><span class="app" ><span class="paren" >(</span><span class="var" ><span class="name name-S" >S</span></span><span class="ap mvar-num-51" >51</span><span class="not-erased mvar mvar-51" ><span class="app" ><span class="paren" >(</span><span class="var" ><span class="name name-S" >S</span></span><span class="ap mvar-num-52" >52</span><span class="not-erased mvar mvar-52" ><span class="var" ><span class="name name-Z" >Z</span></span></span><span class="paren" >)</span></span></span><span class="paren" >)</span></span></span><span class="paren" >)</span></span><span class="ap mvar-num-49" >49</span><span class="erased mvar mvar-49" ><span class="var" ><span class="name name-Bool" >Bool</span></span></span><span class="paren" >)</span></span>
</span></li>
<li class="" ><span class="not-erased " ><span class="name name-main" >main</span><span class="rel rel-R" > :<sub>R</sub> </span><span class="var" ><span class="name name-Nat" >Nat</span></span>
</span></li>
</ul>
<h2>Constraints</h2>
<div class="constraints" ><span class="constr constr-0" ><span class="uses" ><span class="op" >{</span><span class="op" >}</span></span><span class="op" > &#8594; </span><span class="guards" ><span class="op" >{</span><span class="meta mvar mvar-1" >1</span><span class="op" >, </span><span class="meta mvar mvar-2" >2</span><span class="op" >, </span><span class="meta mvar mvar-3" >3</span><span class="op" >, </span><span class="meta mvar mvar-5" >5</span><span class="op" >, </span><span class="meta mvar mvar-6" >6</span><span class="op" >, </span><span class="meta mvar mvar-10" >10</span><span class="op" >, </span><span class="meta mvar mvar-11" >11</span><span class="op" >, </span><span class="meta mvar mvar-14" >14</span><span class="op" >, </span><span class="meta mvar mvar-15" >15</span><span class="op" >, </span><span class="meta mvar mvar-16" >16</span><span class="op" >, </span><span class="meta mvar mvar-17" >17</span><span class="op" >, </span><span class="meta mvar mvar-18" >18</span><span class="op" >, </span><span class="meta mvar mvar-23" >23</span><span class="op" >, </span><span class="meta mvar mvar-24" >24</span><span class="op" >, </span><span class="meta mvar mvar-27" >27</span><span class="op" >, </span><span class="meta mvar mvar-32" >32</span><span class="op" >, </span><span class="meta mvar mvar-35" >35</span><span class="op" >, </span><span class="meta mvar mvar-36" >36</span><span class="op" >, </span><span class="meta mvar mvar-37" >37</span><span class="op" >, </span><span class="meta mvar mvar-38" >38</span><span class="op" >, </span><span class="meta mvar mvar-39" >39</span><span class="op" >, </span><span class="meta mvar mvar-40" >40</span><span class="op" >, </span><span class="meta mvar mvar-43" >43</span><span class="op" >, </span><span class="meta mvar mvar-44" >44</span><span class="op" >, </span><span class="meta mvar mvar-45" >45</span><span class="op" >, </span><span class="meta mvar mvar-48" >48</span><span class="op" >, </span><span class="meta mvar mvar-51" >51</span><span class="op" >, </span><span class="meta mvar mvar-52" >52</span><span class="op" >, </span><span class="meta mvar mvar-53" >53</span><span class="op" >, </span><span class="meta mvar mvar-54" >54</span><span class="op" >, </span><span class="meta mvar mvar-55" >55</span><span class="op" >, </span><span class="meta mvar mvar-56" >56</span><span class="op" >, </span><span class="meta mvar mvar-57" >57</span><span class="op" >, </span><span class="meta mvar mvar-58" >58</span><span class="op" >, </span><span class="meta mvar mvar-59" >59</span><span class="op" >, </span><span class="meta mvar mvar-60" >60</span><span class="op" >, </span><span class="meta mvar mvar-61" >61</span><span class="op" >, </span><span class="meta mvar mvar-62" >62</span><span class="op" >, </span><span class="meta mvar mvar-63" >63</span><span class="op" >, </span><span class="meta mvar mvar-66" >66</span><span class="op" >, </span><span class="meta mvar mvar-67" >67</span><span class="op" >, </span><span class="meta-R" >R</span><span class="op" >}</span></span></span>, <span class="constr constr-1" ><span class="uses" ><span class="op" >{</span><span class="meta mvar mvar-12" >12</span><span class="op" >}</span></span><span class="op" > &#8594; </span><span class="guards" ><span class="op" >{</span><span class="meta mvar mvar-19" >19</span><span class="op" >, </span><span class="meta mvar mvar-28" >28</span><span class="op" >}</span></span></span>, <span class="constr constr-2" ><span class="uses" ><span class="op" >{</span><span class="meta mvar mvar-13" >13</span><span class="op" >}</span></span><span class="op" > &#8594; </span><span class="guards" ><span class="op" >{</span><span class="meta mvar mvar-20" >20</span><span class="op" >, </span><span class="meta mvar mvar-29" >29</span><span class="op" >}</span></span></span>, <span class="constr constr-3" ><span class="uses" ><span class="op" >{</span><span class="meta mvar mvar-19" >19</span><span class="op" >}</span></span><span class="op" > &#8594; </span><span class="guards" ><span class="op" >{</span><span class="meta mvar mvar-12" >12</span><span class="op" >, </span><span class="meta mvar mvar-21" >21</span><span class="op" >, </span><span class="meta mvar mvar-41" >41</span><span class="op" >}</span></span></span>, <span class="constr constr-4" ><span class="uses" ><span class="op" >{</span><span class="meta mvar mvar-20" >20</span><span class="op" >}</span></span><span class="op" > &#8594; </span><span class="guards" ><span class="op" >{</span><span class="meta mvar mvar-13" >13</span><span class="op" >, </span><span class="meta mvar mvar-22" >22</span><span class="op" >, </span><span class="meta mvar mvar-42" >42</span><span class="op" >}</span></span></span>, <span class="constr constr-5" ><span class="uses" ><span class="op" >{</span><span class="meta mvar mvar-21" >21</span><span class="op" >}</span></span><span class="op" > &#8594; </span><span class="guards" ><span class="op" >{</span><span class="meta mvar mvar-19" >19</span><span class="op" >, </span><span class="meta mvar mvar-28" >28</span><span class="op" >, </span><span class="meta mvar mvar-49" >49</span><span class="op" >}</span></span></span>, <span class="constr constr-6" ><span class="uses" ><span class="op" >{</span><span class="meta mvar mvar-22" >22</span><span class="op" >}</span></span><span class="op" > &#8594; </span><span class="guards" ><span class="op" >{</span><span class="meta mvar mvar-20" >20</span><span class="op" >, </span><span class="meta mvar mvar-29" >29</span><span class="op" >, </span><span class="meta mvar mvar-50" >50</span><span class="op" >}</span></span></span>, <span class="constr constr-7" ><span class="uses" ><span class="op" >{</span><span class="meta mvar mvar-25" >25</span><span class="op" >}</span></span><span class="op" > &#8594; </span><span class="guards" ><span class="op" >{</span><span class="meta mvar mvar-30" >30</span><span class="op" >, </span><span class="meta mvar mvar-47" >47</span><span class="op" >, </span><span class="meta mvar mvar-65" >65</span><span class="op" >}</span></span></span>, <span class="constr constr-8" ><span class="uses" ><span class="op" >{</span><span class="meta mvar mvar-26" >26</span><span class="op" >}</span></span><span class="op" > &#8594; </span><span class="guards" ><span class="op" >{</span><span class="meta mvar mvar-31" >31</span><span class="op" >, </span><span class="meta mvar mvar-46" >46</span><span class="op" >, </span><span class="meta mvar mvar-64" >64</span><span class="op" >}</span></span></span>, <span class="constr constr-9" ><span class="uses" ><span class="op" >{</span><span class="meta mvar mvar-28" >28</span><span class="op" >}</span></span><span class="op" > &#8594; </span><span class="guards" ><span class="op" >{</span><span class="meta mvar mvar-12" >12</span><span class="op" >, </span><span class="meta mvar mvar-21" >21</span><span class="op" >, </span><span class="meta mvar mvar-41" >41</span><span class="op" >, </span><span class="meta mvar mvar-49" >49</span><span class="op" >}</span></span></span>, <span class="constr constr-10" ><span class="uses" ><span class="op" >{</span><span class="meta mvar mvar-29" >29</span><span class="op" >}</span></span><span class="op" > &#8594; </span><span class="guards" ><span class="op" >{</span><span class="meta mvar mvar-13" >13</span><span class="op" >, </span><span class="meta mvar mvar-22" >22</span><span class="op" >, </span><span class="meta mvar mvar-42" >42</span><span class="op" >, </span><span class="meta mvar mvar-50" >50</span><span class="op" >}</span></span></span>, <span class="constr constr-11" ><span class="uses" ><span class="op" >{</span><span class="meta mvar mvar-30" >30</span><span class="op" >}</span></span><span class="op" > &#8594; </span><span class="guards" ><span class="op" >{</span><span class="meta mvar mvar-25" >25</span><span class="op" >}</span></span></span>, <span class="constr constr-12" ><span class="uses" ><span class="op" >{</span><span class="meta mvar mvar-31" >31</span><span class="op" >}</span></span><span class="op" > &#8594; </span><span class="guards" ><span class="op" >{</span><span class="meta mvar mvar-26" >26</span><span class="op" >}</span></span></span>, <span class="constr constr-13" ><span class="uses" ><span class="op" >{</span><span class="meta mvar mvar-41" >41</span><span class="op" >}</span></span><span class="op" > &#8594; </span><span class="guards" ><span class="op" >{</span><span class="meta mvar mvar-19" >19</span><span class="op" >, </span><span class="meta mvar mvar-28" >28</span><span class="op" >}</span></span></span>, <span class="constr constr-14" ><span class="uses" ><span class="op" >{</span><span class="meta mvar mvar-42" >42</span><span class="op" >}</span></span><span class="op" > &#8594; </span><span class="guards" ><span class="op" >{</span><span class="meta mvar mvar-20" >20</span><span class="op" >, </span><span class="meta mvar mvar-29" >29</span><span class="op" >}</span></span></span>, <span class="constr constr-15" ><span class="uses" ><span class="op" >{</span><span class="meta mvar mvar-46" >46</span><span class="op" >}</span></span><span class="op" > &#8594; </span><span class="guards" ><span class="op" >{</span><span class="meta mvar mvar-26" >26</span><span class="op" >}</span></span></span>, <span class="constr constr-16" ><span class="uses" ><span class="op" >{</span><span class="meta mvar mvar-47" >47</span><span class="op" >}</span></span><span class="op" > &#8594; </span><span class="guards" ><span class="op" >{</span><span class="meta mvar mvar-25" >25</span><span class="op" >}</span></span></span>, <span class="constr constr-17" ><span class="uses" ><span class="op" >{</span><span class="meta mvar mvar-49" >49</span><span class="op" >}</span></span><span class="op" > &#8594; </span><span class="guards" ><span class="op" >{</span><span class="meta mvar mvar-21" >21</span><span class="op" >, </span><span class="meta mvar mvar-28" >28</span><span class="op" >}</span></span></span>, <span class="constr constr-18" ><span class="uses" ><span class="op" >{</span><span class="meta mvar mvar-50" >50</span><span class="op" >}</span></span><span class="op" > &#8594; </span><span class="guards" ><span class="op" >{</span><span class="meta mvar mvar-22" >22</span><span class="op" >, </span><span class="meta mvar mvar-29" >29</span><span class="op" >}</span></span></span>, <span class="constr constr-19" ><span class="uses" ><span class="op" >{</span><span class="meta mvar mvar-64" >64</span><span class="op" >}</span></span><span class="op" > &#8594; </span><span class="guards" ><span class="op" >{</span><span class="meta mvar mvar-26" >26</span><span class="op" >}</span></span></span>, <span class="constr constr-20" ><span class="uses" ><span class="op" >{</span><span class="meta mvar mvar-65" >65</span><span class="op" >}</span></span><span class="op" > &#8594; </span><span class="guards" ><span class="op" >{</span><span class="meta mvar mvar-25" >25</span><span class="op" >}</span></span></span>, </div>
<script>var constrs=[
[[],["1","2","3","5","6","10","11","14","15","16","17","18","23","24","27","32","35","36","37","38","39","40","43","44","45","48","51","52","53","54","55","56","57","58","59","60","61","62","63","66","67","R"]],
[["12"],["19","28"]],
[["13"],["20","29"]],
[["19"],["12","21","41"]],
[["20"],["13","22","42"]],
[["21"],["19","28","49"]],
[["22"],["20","29","50"]],
[["25"],["30","47","65"]],
[["26"],["31","46","64"]],
[["28"],["12","21","41","49"]],
[["29"],["13","22","42","50"]],
[["30"],["25"]],
[["31"],["26"]],
[["41"],["19","28"]],
[["42"],["20","29"]],
[["46"],["26"]],
[["47"],["25"]],
[["49"],["21","28"]],
[["50"],["22","29"]],
[["64"],["26"]],
[["65"],["25"]],

[]];</script></body></html>
