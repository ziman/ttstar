-- vim: ft=agda

### Desugared ###

postulate Bool : Type

postulate T : Bool

postulate F : Bool

postulate TwoBools : Type

postulate TB : (x :R: Bool) -> (y :R: Bool) -> TwoBools

id : (x : Bool) -> Bool = (\x : Bool. x)

constT : (_ : Bool) -> Bool = (\_ : Bool. T)

fty : (x : Bool) -> Type = \(x : Bool).
  case x of
    T
      => (_ : Bool) -> Bool
    F
      => (_ : Bool) -> Bool

f : (x : Bool) -> fty x = \(x : Bool).
  case x of
    T
      => id
    F
      => constT

main :R: TwoBools = TB (f T F) (f F F)

### Metaified ###

postulate Bool :1: Type

postulate T :2: Bool

postulate F :3: Bool

postulate TwoBools :4: Type

postulate TB :5: (x :R: Bool) -> (y :R: Bool) -> TwoBools

id :6: (x :7: Bool) -> Bool = (\x :8: Bool. x)

constT :9: (_ :10: Bool) -> Bool = (\_ :11: Bool. T)

fty :12: (x :13: Bool) -> Type = \(x :14: Bool).
  case -15- x of
    T
      => (_ :16: Bool) -> Bool
    F
      => (_ :17: Bool) -> Bool

f :18: (x :19: Bool) -> fty -20- x = \(x :21: Bool).
  case -22- x of
    T
      => id
    F
      => constT

main :R: TwoBools = TB -24- (f -26- T -25- F) -23- (f -28- F -27- F)

### Inferred definitions ###

postulate Bool :1: Type {- constraints apply -}
  [] -> [1,R]

postulate F :3: Bool {- constraints apply -}
  [] -> [1,3,R]

postulate T :2: Bool {- constraints apply -}
  [] -> [1,2,R]

postulate TB :5: (x :R: Bool) -> (y :R: Bool) -> TwoBools {- constraints apply -}
  [] -> [4,5,R]

postulate TwoBools :4: Type {- constraints apply -}
  [] -> [4,R]

postulate Type :R: Type

constT :9: (_ :10: Bool) -> Bool = (\_ :11: Bool. T) {- constraints apply -}
  [] -> [1,2,9,R]
  [10] -> [11]
  [11] -> [10]

f :18: (x :19: Bool) -> fty -20- x = \(x :21: Bool).
  case -22- x of
    T
      => id
    F
      => constT {- constraints apply -}
  [] -> [1,2,6,7,8,9,12,13,14,15,16,18,19,20,21,22,R]
  [10] -> [11,17]
  [11] -> [10]
  [17] -> [10]

fty :12: (x :13: Bool) -> Type = \(x :14: Bool).
  case -15- x of
    T
      => (_ :16: Bool) -> Bool
    F
      => (_ :17: Bool) -> Bool {- constraints apply -}
  [] -> [1,12,13,14,15,R]

id :6: (x :7: Bool) -> Bool = (\x :8: Bool. x) {- constraints apply -}
  [] -> [1,6,7,8,R]

main :R: TwoBools = TB -24- (f -26- T -25- F) -23- (f -28- F -27- F) {- constraints apply -}
  [] -> [1,2,3,4,5,6,7,8,9,12,13,14,15,16,18,19,20,21,22,23,24,25,26,28,R]
  [10] -> [11,17]
  [11] -> [10]
  [17] -> [10,27]
  [27] -> [17]


### Constraints ###

[] -> [1,2,3,4,5,6,7,8,9,12,13,14,15,16,18,19,20,21,22,23,24,25,26,28,R]
[10] -> [11,17]
[11] -> [10]
[17] -> [10,27]
[27] -> [17]

### Solution ###

[1,2,3,4,5,6,7,8,9,12,13,14,15,16,18,19,20,21,22,23,24,25,26,28,R]

### Annotated ###

postulate Bool :R: Type

postulate T :R: Bool

postulate F :R: Bool

postulate TwoBools :R: Type

postulate TB :R: (x :R: Bool) -> (y :R: Bool) -> TwoBools

id :R: (x :R: Bool) -> Bool = (\x :R: Bool. x)

constT :R: (_ :E: Bool) -> Bool = (\_ :E: Bool. T)

fty :R: (x :R: Bool) -> Type = \(x :R: Bool).
  case -R- x of
    T
      => (_ :R: Bool) -> Bool
    F
      => (_ :E: Bool) -> Bool

f :R: (x :R: Bool) -> fty -R- x = \(x :R: Bool).
  case -R- x of
    T
      => id
    F
      => constT

main :R: TwoBools = TB -R- (f -R- T -R- F) -R- (f -R- F -E- F)

### Specialised ###

postulate Bool :R: Type

postulate T :R: Bool

postulate F :R: Bool

postulate TwoBools :R: Type

postulate TB :R: (x :R: Bool) -> (y :R: Bool) -> TwoBools

id :R: (x :R: Bool) -> Bool = (\x :R: Bool. x)

constT :R: (_ :E: Bool) -> Bool = (\_ :E: Bool. T)

fty :R: (x :R: Bool) -> Type = \(x :R: Bool).
  case -R- x of
    T
      => (_ :R: Bool) -> Bool
    F
      => (_ :E: Bool) -> Bool

f :R: (x :R: Bool) -> fty -R- x = \(x :R: Bool).
  case -R- x of
    T
      => id
    F
      => constT

main :R: TwoBools = TB -R- (f -R- T -R- F) -R- (f -R- F -E- F)

### Final annotation ###

postulate Bool :R: Type

postulate T :R: Bool

postulate F :R: Bool

postulate TwoBools :R: Type

postulate TB :R: (x :R: Bool) -> (y :R: Bool) -> TwoBools

id :R: (x :R: Bool) -> Bool = (\x :R: Bool. x)

constT :R: (_ :E: Bool) -> Bool = (\_ :E: Bool. T)

fty :R: (x :R: Bool) -> Type = \(x :R: Bool).
  case -R- x of
    T
      => (_ :R: Bool) -> Bool
    F
      => (_ :E: Bool) -> Bool

f :R: (x :R: Bool) -> fty -R- x = \(x :R: Bool).
  case -R- x of
    T
      => id
    F
      => constT

main :R: TwoBools = TB -R- (f -R- T -R- F) -R- (f -R- F -E- F)

### Verification ###

Verification successful.

### Pruned ###

postulate Bool

postulate T

postulate F

postulate TwoBools

postulate TB

id = (\x. x)

constT = T

fty = \x.
  case x of
    T
      => (_) -> Bool
    F
      => Bool

f = \x.
  case x of
    T
      => id
    F
      => constT

main = TB (f T F) (f F)

### Normal forms ###

unerased:
  TB F T
erased:
  TB F T
