-- vim: ft=agda

### Desugared ###

Bool : *

True : Bool

False : Bool

Nat : *

Z : Nat

S : (n : -R-  Nat) -> Nat

Vec : (_ :: Nat) -> (_ :: *) -> *

VNil : (a :: *) -> (Vec  Z  a)

VCons : (a :: *) -> (n :: Nat) -> (x :: a) -> (xs :: (Vec  n  a)) -> (Vec  (S  n)  a)

vlen : (a :: *) -> (n :: Nat) -> (xs :: (Vec  n  a)) -> Nat
vlen = \a :: *. \n :: Nat. \xs :: (Vec  n  a). 
  case xs of
    VNil (a : *) -> Z
    VCons (a : *) (n : Nat) (x : a) (xs : (Vec  n  a)) -> (S  (vlen  a  n  xs))

testVec : (Vec  2  Bool)
testVec = (VCons  Bool  1  True  (VCons  Bool  Z  False  (VNil  Bool)))

main  -R-  Nat
main = (vlen  Bool  2  testVec)

### Metaified ###

Bool :?1: *

True :?2: Bool

False :?3: Bool

Nat :?4: *

Z :?5: Nat

S :?6: (n :?7::!R: Nat) -> Nat

Vec :?8: (_ :?10::?9: Nat) -> (_ :?12::?11: *) -> *

VNil :?13: (a :?15::?14: *) -> (Vec -?18-  -?19- Z -?16-  -?17- a)

VCons :?20: (a :?22::?21: *) -> (n :?24::?23: Nat) -> (x :?26::?25: a) -> (xs :?32::?27: (Vec -?30-  -?31- n -?28-  -?29- a)) -> (Vec -?35-  -?36- (S -?37-  -?38- n) -?33-  -?34- a)

vlen :?39: (a :?41::?40: *) -> (n :?43::?42: Nat) -> (xs :?49::?44: (Vec -?47-  -?48- n -?45-  -?46- a)) -> Nat
vlen = \a :?51::?50: *. \n :?53::?52: Nat. \xs :?59::?54: (Vec -?57-  -?58- n -?55-  -?56- a). 
  case xs of
    VNil (a :?60: *) -> Z
    VCons (a :?62: *) (n :?64: Nat) (x :?66: a) (xs :?68: (Vec -?71-  -?72- n -?69-  -?70- a)) -> (S -?74-  -?75- (vlen -?80-  -?81- a -?78-  -?79- n -?76-  -?77- xs))

testVec :?82: (Vec -?85-  -?86- 2 -?83-  -?84- Bool)
testVec = (VCons -?97-  -?98- Bool -?95-  -?96- 1 -?93-  -?94- True -?91-  -?92- (VCons -?107-  -?108- Bool -?105-  -?106- Z -?103-  -?104- False -?101-  -?102- (VNil -?109-  -?110- Bool)))

main :!R: Nat
main = (vlen -?115-  -?116- Bool -?113-  -?114- 2 -?111-  -?112- testVec)

### Inferred definitions ###

Bool :?1: *
False :?3: Bool
Nat :?4: *
S :?6: (n :?7::!R: Nat) -> Nat
True :?2: Bool
VCons :?20: (a :?22::?21: *) -> (n :?24::?23: Nat) -> (x :?26::?25: a) -> (xs :?32::?27: (Vec -?30-  -?31- n -?28-  -?29- a)) -> (Vec -?35-  -?36- (S -?37-  -?38- n) -?33-  -?34- a)
VNil :?13: (a :?15::?14: *) -> (Vec -?18-  -?19- Z -?16-  -?17- a)
Vec :?8: (_ :?10::?9: Nat) -> (_ :?12::?11: *) -> *
Z :?5: Nat
main :!R: Nat
  [] -> [?5_1,?6_1,?20_2,?27_1,?39,?39_1,?44_1,?49,?54_1,?68_1,?75_1,?77_1,?82,?111,?112,!R]
  [?7,?42_1] -> [?117,?119]
  [?7_1] -> [?74_1]
  [?7_2,?23_2] -> [?99_2]
  [?14_2,?27_2] -> [?1_2,?110_2]
  [?15_2,?27_2] -> [?109_2]
  [?16_2,?27_2] -> [?28_2]
  [?17_2,?27_2] -> [?29_2]
  [?18_2,?27_2] -> [?30_2]
  [?19_2,?27_2] -> [?31_2]
  [?21_2] -> [?1_2,?98_2]
  [?21_2,?27_2] -> [?1_2,?108_2]
  [?22_2] -> [?97_2]
  [?22_2,?27_2] -> [?107_2]
  [?23_2] -> [?5_2,?6_2,?96_2,?100_2]
  [?23_2,?27_2] -> [?5_2,?106_2]
  [?23_2,?99_2] -> [?7_2]
  [?24_2] -> [?95_2]
  [?24_2,?27_2] -> [?105_2]
  [?25_2] -> [?2_2,?94_2]
  [?25_2,?27_2] -> [?3_2,?104_2]
  [?26_2] -> [?93_2]
  [?26_2,?27_2] -> [?103_2]
  [?27_2] -> [?13_2,?92_2,?102_2]
  [?27_2,?28_2] -> [?16_2]
  [?27_2,?29_2] -> [?17_2]
  [?27_2,?30_2] -> [?18_2]
  [?27_2,?31_2] -> [?19_2]
  [?27_2,?32_2] -> [?101_2]
  [?27_2,?101_2] -> [?32_2]
  [?27_2,?102_2] -> [?27_2]
  [?27_2,?103_2] -> [?26_2]
  [?27_2,?104_2] -> [?25_2]
  [?27_2,?105_2] -> [?24_2]
  [?27_2,?106_2] -> [?23_2]
  [?27_2,?107_2] -> [?22_2]
  [?27_2,?108_2] -> [?21_2]
  [?27_2,?109_2] -> [?15_2]
  [?27_2,?110_2] -> [?14_2]
  [?28_1] -> [?69_1]
  [?28_2] -> [?33_2]
  [?29_1] -> [?70_1]
  [?29_2] -> [?34_2]
  [?30_1] -> [?71_1]
  [?30_2] -> [?35_2]
  [?31_1] -> [?72_1]
  [?31_2] -> [?36_2]
  [?32_2] -> [?91_2]
  [?33_2] -> [?28_2,?83_2]
  [?34_2] -> [?29_2,?84_2]
  [?35_2] -> [?30_2,?85_2]
  [?36_2] -> [?31_2,?86_2]
  [?37_2] -> [?87_2,?99_2]
  [?38_2] -> [?88_2,?100_2]
  [?40_1] -> [?1,?41,?50_1,?62_1,?81_1,?116]
  [?41] -> [?115]
  [?41_1] -> [?51_1,?80_1]
  [?42_1] -> [?5,?6,?43,?52_1,?64_1,?79_1,?114,?118,?120]
  [?42_1,?117] -> [?7]
  [?42_1,?119] -> [?7]
  [?43] -> [?113]
  [?43_1] -> [?53_1,?78_1]
  [?45_1] -> [?55_1,?69_1,?83_2]
  [?46_1] -> [?56_1,?70_1,?84_2]
  [?47_1] -> [?57_1,?71_1,?85_2]
  [?48_1] -> [?58_1,?72_1,?86_2]
  [?49_1] -> [?59_1,?76_1]
  [?50_1] -> [?40_1]
  [?51_1] -> [?41_1]
  [?52_1] -> [?42_1]
  [?53_1] -> [?43_1]
  [?55_1] -> [?45_1]
  [?56_1] -> [?46_1]
  [?57_1] -> [?47_1]
  [?58_1] -> [?48_1]
  [?59_1] -> [?49_1]
  [?60_1] -> [?14_1]
  [?62_1] -> [?21_1]
  [?64_1] -> [?23_1]
  [?66_1] -> [?25_1]
  [?69_1] -> [?28_1,?45_1]
  [?70_1] -> [?29_1,?46_1]
  [?71_1] -> [?30_1,?47_1]
  [?72_1] -> [?31_1,?48_1]
  [?74_1] -> [?7_1]
  [?76_1] -> [?49_1]
  [?78_1] -> [?43_1]
  [?79_1] -> [?42_1]
  [?80_1] -> [?41_1]
  [?81_1] -> [?40_1]
  [?83_2] -> [?33_2,?45_1]
  [?84_2] -> [?34_2,?46_1]
  [?85_2] -> [?35_2,?47_1]
  [?86_2] -> [?36_2,?48_1]
  [?87_2] -> [?37_2,?117]
  [?88_2] -> [?38_2,?118]
  [?89_2] -> [?99_2,?119]
  [?90_2] -> [?100_2,?120]
  [?91_2] -> [?32_2]
  [?92_2] -> [?27_2]
  [?93_2] -> [?26_2]
  [?94_2] -> [?25_2]
  [?95_2] -> [?24_2]
  [?96_2] -> [?23_2]
  [?97_2] -> [?22_2]
  [?98_2] -> [?21_2]
  [?99_2] -> [?37_2,?89_2]
  [?100_2] -> [?38_2,?90_2]
  [?113] -> [?43]
  [?114] -> [?42_1]
  [?115] -> [?41]
  [?116] -> [?40_1]
  [?117] -> [?87_2]
  [?118] -> [?88_2]
  [?119] -> [?89_2]
  [?120] -> [?90_2]

testVec :?82: (Vec -?85-  -?86- 2 -?83-  -?84- Bool)
  [] -> [?20,!R]
  [?7,?23] -> [?99]
  [?14,?27] -> [?1,?110]
  [?15,?27] -> [?109]
  [?16,?27] -> [?28]
  [?17,?27] -> [?29]
  [?18,?27] -> [?30]
  [?19,?27] -> [?31]
  [?21] -> [?1,?98]
  [?21,?27] -> [?1,?108]
  [?22] -> [?97]
  [?22,?27] -> [?107]
  [?23] -> [?5,?6,?96,?100]
  [?23,?27] -> [?5,?106]
  [?23,?99] -> [?7]
  [?24] -> [?95]
  [?24,?27] -> [?105]
  [?25] -> [?2,?94]
  [?25,?27] -> [?3,?104]
  [?26] -> [?93]
  [?26,?27] -> [?103]
  [?27] -> [?13,?92,?102]
  [?27,?28] -> [?16]
  [?27,?29] -> [?17]
  [?27,?30] -> [?18]
  [?27,?31] -> [?19]
  [?27,?32] -> [?101]
  [?27,?101] -> [?32]
  [?27,?102] -> [?27]
  [?27,?103] -> [?26]
  [?27,?104] -> [?25]
  [?27,?105] -> [?24]
  [?27,?106] -> [?23]
  [?27,?107] -> [?22]
  [?27,?108] -> [?21]
  [?27,?109] -> [?15]
  [?27,?110] -> [?14]
  [?28] -> [?33]
  [?29] -> [?34]
  [?30] -> [?35]
  [?31] -> [?36]
  [?32] -> [?91]
  [?33] -> [?28,?83]
  [?34] -> [?29,?84]
  [?35] -> [?30,?85]
  [?36] -> [?31,?86]
  [?37] -> [?87,?99]
  [?38] -> [?88,?100]
  [?83] -> [?33]
  [?84] -> [?34]
  [?85] -> [?35]
  [?86] -> [?36]
  [?87] -> [?37]
  [?88] -> [?38]
  [?89] -> [?99]
  [?90] -> [?100]
  [?91] -> [?32]
  [?92] -> [?27]
  [?93] -> [?26]
  [?94] -> [?25]
  [?95] -> [?24]
  [?96] -> [?23]
  [?97] -> [?22]
  [?98] -> [?21]
  [?99] -> [?37,?89]
  [?100] -> [?38,?90]

vlen :?39: (a :?41::?40: *) -> (n :?43::?42: Nat) -> (xs :?49::?44: (Vec -?47-  -?48- n -?45-  -?46- a)) -> Nat
  [] -> [?5,?6,?27,?39,?44,?54,?68,?75,?77,!R]
  [?7] -> [?74]
  [?28] -> [?69]
  [?29] -> [?70]
  [?30] -> [?71]
  [?31] -> [?72]
  [?40] -> [?50,?62,?81]
  [?41] -> [?51,?80]
  [?42] -> [?52,?64,?79]
  [?43] -> [?53,?78]
  [?45] -> [?55,?69]
  [?46] -> [?56,?70]
  [?47] -> [?57,?71]
  [?48] -> [?58,?72]
  [?49] -> [?59,?76]
  [?50] -> [?40]
  [?51] -> [?41]
  [?52] -> [?42]
  [?53] -> [?43]
  [?55] -> [?45]
  [?56] -> [?46]
  [?57] -> [?47]
  [?58] -> [?48]
  [?59] -> [?49]
  [?60] -> [?14]
  [?62] -> [?21]
  [?64] -> [?23]
  [?66] -> [?25]
  [?69] -> [?28,?45]
  [?70] -> [?29,?46]
  [?71] -> [?30,?47]
  [?72] -> [?31,?48]
  [?74] -> [?7]
  [?76] -> [?49]
  [?78] -> [?43]
  [?79] -> [?42]
  [?80] -> [?41]
  [?81] -> [?40]


### Constraints ###

[] -> [?5,?5_1,?6,?6_1,?20,?20_2,?27,?27_1,?39,?39_1,?44,?44_1,?49,?54,?54_1,?68,?68_1,?75,?75_1,?77,?77_1,?82,?111,?112,!R]
[?7] -> [?74]
[?7,?23] -> [?99]
[?7,?42_1] -> [?117,?119]
[?7_1] -> [?74_1]
[?7_2,?23_2] -> [?99_2]
[?14,?27] -> [?1,?110]
[?14_2,?27_2] -> [?1_2,?110_2]
[?15,?27] -> [?109]
[?15_2,?27_2] -> [?109_2]
[?16,?27] -> [?28]
[?16_2,?27_2] -> [?28_2]
[?17,?27] -> [?29]
[?17_2,?27_2] -> [?29_2]
[?18,?27] -> [?30]
[?18_2,?27_2] -> [?30_2]
[?19,?27] -> [?31]
[?19_2,?27_2] -> [?31_2]
[?21] -> [?1,?98]
[?21,?27] -> [?1,?108]
[?21_2] -> [?1_2,?98_2]
[?21_2,?27_2] -> [?1_2,?108_2]
[?22] -> [?97]
[?22,?27] -> [?107]
[?22_2] -> [?97_2]
[?22_2,?27_2] -> [?107_2]
[?23] -> [?5,?6,?96,?100]
[?23,?27] -> [?5,?106]
[?23,?99] -> [?7]
[?23_2] -> [?5_2,?6_2,?96_2,?100_2]
[?23_2,?27_2] -> [?5_2,?106_2]
[?23_2,?99_2] -> [?7_2]
[?24] -> [?95]
[?24,?27] -> [?105]
[?24_2] -> [?95_2]
[?24_2,?27_2] -> [?105_2]
[?25] -> [?2,?94]
[?25,?27] -> [?3,?104]
[?25_2] -> [?2_2,?94_2]
[?25_2,?27_2] -> [?3_2,?104_2]
[?26] -> [?93]
[?26,?27] -> [?103]
[?26_2] -> [?93_2]
[?26_2,?27_2] -> [?103_2]
[?27] -> [?13,?92,?102]
[?27,?28] -> [?16]
[?27,?29] -> [?17]
[?27,?30] -> [?18]
[?27,?31] -> [?19]
[?27,?32] -> [?101]
[?27,?101] -> [?32]
[?27,?102] -> [?27]
[?27,?103] -> [?26]
[?27,?104] -> [?25]
[?27,?105] -> [?24]
[?27,?106] -> [?23]
[?27,?107] -> [?22]
[?27,?108] -> [?21]
[?27,?109] -> [?15]
[?27,?110] -> [?14]
[?27_2] -> [?13_2,?92_2,?102_2]
[?27_2,?28_2] -> [?16_2]
[?27_2,?29_2] -> [?17_2]
[?27_2,?30_2] -> [?18_2]
[?27_2,?31_2] -> [?19_2]
[?27_2,?32_2] -> [?101_2]
[?27_2,?101_2] -> [?32_2]
[?27_2,?102_2] -> [?27_2]
[?27_2,?103_2] -> [?26_2]
[?27_2,?104_2] -> [?25_2]
[?27_2,?105_2] -> [?24_2]
[?27_2,?106_2] -> [?23_2]
[?27_2,?107_2] -> [?22_2]
[?27_2,?108_2] -> [?21_2]
[?27_2,?109_2] -> [?15_2]
[?27_2,?110_2] -> [?14_2]
[?28] -> [?33,?69]
[?28_1] -> [?69_1]
[?28_2] -> [?33_2]
[?29] -> [?34,?70]
[?29_1] -> [?70_1]
[?29_2] -> [?34_2]
[?30] -> [?35,?71]
[?30_1] -> [?71_1]
[?30_2] -> [?35_2]
[?31] -> [?36,?72]
[?31_1] -> [?72_1]
[?31_2] -> [?36_2]
[?32] -> [?91]
[?32_2] -> [?91_2]
[?33] -> [?28,?83]
[?33_2] -> [?28_2,?83_2]
[?34] -> [?29,?84]
[?34_2] -> [?29_2,?84_2]
[?35] -> [?30,?85]
[?35_2] -> [?30_2,?85_2]
[?36] -> [?31,?86]
[?36_2] -> [?31_2,?86_2]
[?37] -> [?87,?99]
[?37_2] -> [?87_2,?99_2]
[?38] -> [?88,?100]
[?38_2] -> [?88_2,?100_2]
[?40] -> [?50,?62,?81]
[?40_1] -> [?1,?41,?50_1,?62_1,?81_1,?116]
[?41] -> [?51,?80,?115]
[?41_1] -> [?51_1,?80_1]
[?42] -> [?52,?64,?79]
[?42_1] -> [?5,?6,?43,?52_1,?64_1,?79_1,?114,?118,?120]
[?42_1,?117] -> [?7]
[?42_1,?119] -> [?7]
[?43] -> [?53,?78,?113]
[?43_1] -> [?53_1,?78_1]
[?45] -> [?55,?69]
[?45_1] -> [?55_1,?69_1,?83_2]
[?46] -> [?56,?70]
[?46_1] -> [?56_1,?70_1,?84_2]
[?47] -> [?57,?71]
[?47_1] -> [?57_1,?71_1,?85_2]
[?48] -> [?58,?72]
[?48_1] -> [?58_1,?72_1,?86_2]
[?49] -> [?59,?76]
[?49_1] -> [?59_1,?76_1]
[?50] -> [?40]
[?50_1] -> [?40_1]
[?51] -> [?41]
[?51_1] -> [?41_1]
[?52] -> [?42]
[?52_1] -> [?42_1]
[?53] -> [?43]
[?53_1] -> [?43_1]
[?55] -> [?45]
[?55_1] -> [?45_1]
[?56] -> [?46]
[?56_1] -> [?46_1]
[?57] -> [?47]
[?57_1] -> [?47_1]
[?58] -> [?48]
[?58_1] -> [?48_1]
[?59] -> [?49]
[?59_1] -> [?49_1]
[?60] -> [?14]
[?60_1] -> [?14_1]
[?62] -> [?21]
[?62_1] -> [?21_1]
[?64] -> [?23]
[?64_1] -> [?23_1]
[?66] -> [?25]
[?66_1] -> [?25_1]
[?69] -> [?28,?45]
[?69_1] -> [?28_1,?45_1]
[?70] -> [?29,?46]
[?70_1] -> [?29_1,?46_1]
[?71] -> [?30,?47]
[?71_1] -> [?30_1,?47_1]
[?72] -> [?31,?48]
[?72_1] -> [?31_1,?48_1]
[?74] -> [?7]
[?74_1] -> [?7_1]
[?76] -> [?49]
[?76_1] -> [?49_1]
[?78] -> [?43]
[?78_1] -> [?43_1]
[?79] -> [?42]
[?79_1] -> [?42_1]
[?80] -> [?41]
[?80_1] -> [?41_1]
[?81] -> [?40]
[?81_1] -> [?40_1]
[?83] -> [?33]
[?83_2] -> [?33_2,?45_1]
[?84] -> [?34]
[?84_2] -> [?34_2,?46_1]
[?85] -> [?35]
[?85_2] -> [?35_2,?47_1]
[?86] -> [?36]
[?86_2] -> [?36_2,?48_1]
[?87] -> [?37]
[?87_2] -> [?37_2,?117]
[?88] -> [?38]
[?88_2] -> [?38_2,?118]
[?89] -> [?99]
[?89_2] -> [?99_2,?119]
[?90] -> [?100]
[?90_2] -> [?100_2,?120]
[?91] -> [?32]
[?91_2] -> [?32_2]
[?92] -> [?27]
[?92_2] -> [?27_2]
[?93] -> [?26]
[?93_2] -> [?26_2]
[?94] -> [?25]
[?94_2] -> [?25_2]
[?95] -> [?24]
[?95_2] -> [?24_2]
[?96] -> [?23]
[?96_2] -> [?23_2]
[?97] -> [?22]
[?97_2] -> [?22_2]
[?98] -> [?21]
[?98_2] -> [?21_2]
[?99] -> [?37,?89]
[?99_2] -> [?37_2,?89_2]
[?100] -> [?38,?90]
[?100_2] -> [?38_2,?90_2]
[?113] -> [?43]
[?114] -> [?42_1]
[?115] -> [?41]
[?116] -> [?40_1]
[?117] -> [?87_2]
[?118] -> [?88_2]
[?119] -> [?89_2]
[?120] -> [?90_2]

### Solution ###

[?5,?5_1,?6,?6_1,?13,?20,?20_2,?27,?27_1,?39,?39_1,?44,?44_1,?49,?54,?54_1,?59,?68,?68_1,?75,?75_1,?76,?77,?77_1,?82,?92,?102,?111,?112,!R]

### Annotated ###

Bool :E: *

True :E: Bool

False :E: Bool

Nat :E: *

Z :R: Nat

S :R: (n :E::R: Nat) -> Nat

Vec :E: (_ :E::E: Nat) -> (_ :E::E: *) -> *

VNil :R: (a :E::E: *) -> (Vec -E-  -E- Z -E-  -E- a)

VCons :R: (a :E::E: *) -> (n :E::E: Nat) -> (x :E::E: a) -> (xs :E::R: (Vec -E-  -E- n -E-  -E- a)) -> (Vec -E-  -E- (S -E-  -E- n) -E-  -E- a)

vlen :R: (a :E::E: *) -> (n :E::E: Nat) -> (xs :R::R: (Vec -E-  -E- n -E-  -E- a)) -> Nat
vlen = \a :E::E: *. \n :E::E: Nat. \xs :R::R: (Vec -E-  -E- n -E-  -E- a). 
  case xs of
    VNil (a :E: *) -> Z
    VCons (a :E: *) (n :E: Nat) (x :E: a) (xs :R: (Vec -E-  -E- n -E-  -E- a)) -> (S -E-  -R- (vlen -E-  -E- a -E-  -E- n -R-  -R- xs))

testVec :R: (Vec -E-  -E- 2 -E-  -E- Bool)
testVec = (VCons -E-  -E- Bool -E-  -E- 1 -E-  -E- True -E-  -R- (VCons -E-  -E- Bool -E-  -E- Z -E-  -E- False -E-  -R- (VNil -E-  -E- Bool)))

main :R: Nat
main = (vlen -E-  -E- Bool -E-  -E- 2 -R-  -R- testVec)

### Pruned ###

vlen = \xs. 
  case xs of
    VNil -> Z
    VCons xs -> (S  (vlen  xs))

testVec = (VCons  (VCons  VNil))

main = (vlen  testVec)

### Normal forms ###

unerased:
  2
erased:
  2
