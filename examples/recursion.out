-- vim: ft=agda

### Desugared ###

Bool : *

True : Bool

False : Bool

Nat : *

Z : Nat

S : (n : -R-  Nat) -> Nat

Vec : (_ :: Nat) -> (_ :: *) -> *

VNil : (a :: *) -> (Vec  Z  a)

VCons : (a :: *) -> (n :: Nat) -> (x :: a) -> (xs :: (Vec  n  a)) -> (Vec  (S  n)  a)

vlen : (a :: *) -> (n :: Nat) -> (xs :: (Vec  n  a)) -> Nat
vlen = \a :: *. \n :: Nat. \xs :: (Vec  n  a). 
  case xs of
    VNil (a : *) -> Z
    VCons (a : *) (n : Nat) (x : a) (xs : (Vec  n  a)) -> (S  (vlen  a  n  xs))

testVec : (Vec  2  Bool)
testVec = (VCons  Bool  1  True  (VCons  Bool  Z  False  (VNil  Bool)))

main  -R-  Nat
main = (vlen  Bool  2  testVec)

### Metaified ###

Bool :?1: *

True :?2: Bool

False :?3: Bool

Nat :?4: *

Z :?5: Nat

S :?6: (n :?7::!R: Nat) -> Nat

Vec :?8: (_ :?10::?9: Nat) -> (_ :?12::?11: *) -> *

VNil :?13: (a :?15::?14: *) -> (Vec -?18-  -?19- Z -?16-  -?17- a)

VCons :?20: (a :?22::?21: *) -> (n :?24::?23: Nat) -> (x :?26::?25: a) -> (xs :?32::?27: (Vec -?30-  -?31- n -?28-  -?29- a)) -> (Vec -?35-  -?36- (S -?37-  -?38- n) -?33-  -?34- a)

vlen :?39: (a :?41::?40: *) -> (n :?43::?42: Nat) -> (xs :?49::?44: (Vec -?47-  -?48- n -?45-  -?46- a)) -> Nat
vlen = \a :?51::?50: *. \n :?53::?52: Nat. \xs :?59::?54: (Vec -?57-  -?58- n -?55-  -?56- a). 
  case xs of
    VNil (a :?60: *) -> Z
    VCons (a :?62: *) (n :?64: Nat) (x :?66: a) (xs :?68: (Vec -?71-  -?72- n -?69-  -?70- a)) -> (S -?74-  -?75- (vlen -?80-  -?81- a -?78-  -?79- n -?76-  -?77- xs))

testVec :?82: (Vec -?85-  -?86- 2 -?83-  -?84- Bool)
testVec = (VCons -?97-  -?98- Bool -?95-  -?96- 1 -?93-  -?94- True -?91-  -?92- (VCons -?107-  -?108- Bool -?105-  -?106- Z -?103-  -?104- False -?101-  -?102- (VNil -?109-  -?110- Bool)))

main :!R: Nat
main = (vlen -?115-  -?116- Bool -?113-  -?114- 2 -?111-  -?112- testVec)

### Inferred definitions ###

Bool :?1: *
False :?3: Bool
Nat :?4: *
S :?6: (n :?7::!R: Nat) -> Nat
True :?2: Bool
VCons :?20: (a :?22::?21: *) -> (n :?24::?23: Nat) -> (x :?26::?25: a) -> (xs :?32::?27: (Vec -?30-  -?31- n -?28-  -?29- a)) -> (Vec -?35-  -?36- (S -?37-  -?38- n) -?33-  -?34- a)
VNil :?13: (a :?15::?14: *) -> (Vec -?18-  -?19- Z -?16-  -?17- a)
Vec :?8: (_ :?10::?9: Nat) -> (_ :?12::?11: *) -> *
Z :?5: Nat
