-- vim: ft=agda

### Desugared ###

Bool : *

True : Bool

False : Bool

Maybe : (_ :: *) -> *

Just : (a :: *) -> (_ :: a) -> *

Nothing : (a :: *) -> *

Nat : *

Z : Nat

S : (n : -R-  Nat) -> Nat

Plus : (x : -R-  Nat) -> (y : -R-  Nat) -> Nat

id : (_ :: Nat) -> Nat
id = \y :: Nat. y

const_3 : (_ :: Nat) -> Nat
const_3 = \_ :: Nat. 3

two : Nat
two = 2

f : (g :: (_ :: Nat) -> Nat) -> (z :: Nat) -> (h :: (_ :: Nat) -> Nat) -> (w :: Nat) -> Nat
f = \g :: (_ :: Nat) -> Nat. \z :: Nat. \h :: (_ :: Nat) -> Nat. \w :: Nat. (Plus  (g  z)  (h  w))

apply : (f :: (_ :: Nat) -> Nat) -> (_ :: Nat) -> Nat
apply = \f :: (_ :: Nat) -> Nat. \x :: Nat. (f  x)

test_1 : Nat
test_1 = (Plus  (apply  id  2)  (apply  const_3  two))

test_2 : Nat
test_2 = (f  id  2  const_3  1)

main  -R-  Nat
main = (Plus  test_1  test_2)

### Metaified ###

Bool :?1: *

True :?2: Bool

False :?3: Bool

Maybe :?4: (_ :?6::?5: *) -> *

Just :?7: (a :?9::?8: *) -> (_ :?11::?10: a) -> *

Nothing :?12: (a :?14::?13: *) -> *

Nat :?15: *

Z :?16: Nat

S :?17: (n :?18::!R: Nat) -> Nat

Plus :?19: (x :?20::!R: Nat) -> (y :?21::!R: Nat) -> Nat

id :?22: (_ :?24::?23: Nat) -> Nat
id = \y :?26::?25: Nat. y

const_3 :?27: (_ :?29::?28: Nat) -> Nat
const_3 = \_ :?31::?30: Nat. 3

two :?38: Nat
two = 2

f :?43: (g :?47::?44: (_ :?46::?45: Nat) -> Nat) -> (z :?49::?48: Nat) -> (h :?53::?50: (_ :?52::?51: Nat) -> Nat) -> (w :?55::?54: Nat) -> Nat
f = \g :?59::?56: (_ :?58::?57: Nat) -> Nat. \z :?61::?60: Nat. \h :?65::?62: (_ :?64::?63: Nat) -> Nat. \w :?67::?66: Nat. (Plus -?70-  -?71- (g -?72-  -?73- z) -?68-  -?69- (h -?74-  -?75- w))

apply :?76: (f :?80::?77: (_ :?79::?78: Nat) -> Nat) -> (_ :?82::?81: Nat) -> Nat
apply = \f :?86::?83: (_ :?85::?84: Nat) -> Nat. \x :?88::?87: Nat. (f -?89-  -?90- x)

test_1 :?91: Nat
test_1 = (Plus -?94-  -?95- (apply -?98-  -?99- id -?96-  -?97- 2) -?92-  -?93- (apply -?106-  -?107- const_3 -?104-  -?105- two))

test_2 :?108: Nat
test_2 = (f -?115-  -?116- id -?113-  -?114- 2 -?111-  -?112- const_3 -?109-  -?110- 1)

main :!R: Nat
main = (Plus -?125-  -?126- test_1 -?123-  -?124- test_2)

### Inferred definitions ###

Bool :?1: *
False :?3: Bool
Just :?7: (a :?9::?8: *) -> (_ :?11::?10: a) -> *
Maybe :?4: (_ :?6::?5: *) -> *
Nat :?15: *
Nothing :?12: (a :?14::?13: *) -> *
Plus :?19: (x :?20::!R: Nat) -> (y :?21::!R: Nat) -> Nat
S :?17: (n :?18::!R: Nat) -> Nat
True :?2: Bool
Z :?16: Nat
apply :?76: (f :?80::?77: (_ :?79::?78: Nat) -> Nat) -> (_ :?82::?81: Nat) -> Nat
  [] -> [?77,?83,!R]
  [?78] -> [?84]
  [?79] -> [?85]
  [?80] -> [?86]
  [?81] -> [?87]
  [?82] -> [?88]
  [?84] -> [?78,?87,?90]
  [?85] -> [?79,?89]
  [?86] -> [?80]
  [?87] -> [?81]
  [?88] -> [?82]
  [?89] -> [?85]
  [?90] -> [?84]

const_3 :?27: (_ :?29::?28: Nat) -> Nat
  [] -> [?16,?17,?33,?35,?37,!R]
  [?18] -> [?32,?34,?36]
  [?28] -> [?30]
  [?29] -> [?31]
  [?30] -> [?28]
  [?31] -> [?29]
  [?32] -> [?18]
  [?34] -> [?18]
  [?36] -> [?18]

f :?43: (g :?47::?44: (_ :?46::?45: Nat) -> Nat) -> (z :?49::?48: Nat) -> (h :?53::?50: (_ :?52::?51: Nat) -> Nat) -> (w :?55::?54: Nat) -> Nat
  [] -> [?19,?44,?50,?56,?62,?69,?71,!R]
  [?20] -> [?70]
  [?21] -> [?68]
  [?45] -> [?57]
  [?46] -> [?58]
  [?47] -> [?59]
  [?48] -> [?60]
  [?49] -> [?61]
  [?51] -> [?63]
  [?52] -> [?64]
  [?53] -> [?65]
  [?54] -> [?66]
  [?55] -> [?67]
  [?57] -> [?45,?60,?73]
  [?58] -> [?46,?72]
  [?59] -> [?47]
  [?60] -> [?48]
  [?61] -> [?49]
  [?63] -> [?51,?66,?75]
  [?64] -> [?52,?74]
  [?65] -> [?53]
  [?66] -> [?54]
  [?67] -> [?55]
  [?68] -> [?21]
  [?70] -> [?20]
  [?72] -> [?58]
  [?73] -> [?57]
  [?74] -> [?64]
  [?75] -> [?63]

id :?22: (_ :?24::?23: Nat) -> Nat
  [] -> [?23,?25,!R]
  [?24] -> [?26]
  [?26] -> [?24]

