-- vim: ft=agda

### Desugared ###

Bool : *
Bool = (axiom)

True : Bool
True = (axiom)

False : Bool
False = (axiom)

Maybe : (_ : *) -> *
Maybe = (axiom)

Just : (a : *) -> (_ : a) -> *
Just = (axiom)

Nothing : (a : *) -> *
Nothing = (axiom)

Nat : *
Nat = (axiom)

Z : Nat
Z = (axiom)

S : (n  -R-  Nat) -> Nat
S = (axiom)

Plus : (x  -R-  Nat) -> (y  -R-  Nat) -> Nat
Plus = (axiom)

id : (_ : Nat) -> Nat
id = \y : Nat. y

const_3 : (_ : Nat) -> Nat
const_3 = \_ : Nat. 3

two : Nat
two = 2

f : (g : (_ : Nat) -> Nat) -> (z : Nat) -> (h : (_ : Nat) -> Nat) -> (w : Nat) -> Nat
f = \g : (_ : Nat) -> Nat. \z : Nat. \h : (_ : Nat) -> Nat. \w : Nat. (Plus (g z) (h w))

apply : (f : (_ : Nat) -> Nat) -> (_ : Nat) -> Nat
apply = \f : (_ : Nat) -> Nat. \x : Nat. (f x)

test_1 : Nat
test_1 = (Plus (apply id 2) (apply const_3 two))

test_2 : Nat
test_2 = (f id 2 const_3 1)

main  -R-  Nat
main = (Plus test_1 test_2)

### Metaified ###

Bool :?1: *
Bool = (axiom)

True :?2: Bool
True = (axiom)

False :?3: Bool
False = (axiom)

Maybe :?4: (_ :?5: *) -> *
Maybe = (axiom)

Just :?6: (a :?7: *) -> (_ :?8: a) -> *
Just = (axiom)

Nothing :?9: (a :?10: *) -> *
Nothing = (axiom)

Nat :?11: *
Nat = (axiom)

Z :?12: Nat
Z = (axiom)

S :?13: (n :!R: Nat) -> Nat
S = (axiom)

Plus :?14: (x :!R: Nat) -> (y :!R: Nat) -> Nat
Plus = (axiom)

id :?15: (_ :?16: Nat) -> Nat
id = \y :?17: Nat. y

const_3 :?18: (_ :?19: Nat) -> Nat
const_3 = \_ :?20: Nat. 3

two :?24: Nat
two = 2

f :?27: (g :?28: (_ :?29: Nat) -> Nat) -> (z :?30: Nat) -> (h :?31: (_ :?32: Nat) -> Nat) -> (w :?33: Nat) -> Nat
f = \g :?34: (_ :?35: Nat) -> Nat. \z :?36: Nat. \h :?37: (_ :?38: Nat) -> Nat. \w :?39: Nat. (Plus -?41- (g -?42- z) -?40- (h -?43- w))

apply :?44: (f :?45: (_ :?46: Nat) -> Nat) -> (_ :?47: Nat) -> Nat
apply = \f :?48: (_ :?49: Nat) -> Nat. \x :?50: Nat. (f -?51- x)

test_1 :?52: Nat
test_1 = (Plus -?54- (apply -?56- id -?55- 2) -?53- (apply -?60- const_3 -?59- two))

test_2 :?61: Nat
test_2 = (f -?65- id -?64- 2 -?63- const_3 -?62- 1)

main :!R: Nat
main = (Plus -?70- test_1 -?69- test_2)

### Inferred definitions ###

Bool :?1: *

False :?3: Bool

Just :?6: (a :?7: *) -> (_ :?8: a) -> *

Maybe :?4: (_ :?5: *) -> *

Nat :?11: *

Nothing :?9: (a :?10: *) -> *

Plus :?14: (x :!R: Nat) -> (y :!R: Nat) -> Nat

S :?13: (n :!R: Nat) -> Nat

True :?2: Bool

Z :?12: Nat

apply :?44: (f :?45: (_ :?46: Nat) -> Nat) -> (_ :?47: Nat) -> Nat
  [?44] -> [?48]
  [?45] -> [?48]
  [?46] -> [?49]
  [?47] -> [?50]
  [?48] -> [?45]
  [?49] -> [?46]
  [?49/14] -> [?50,?51]
  [?50] -> [?47]

const_3 :?18: (_ :?19: Nat) -> Nat
  [] -> [?12,?13,?21,?22,?23,!R]
  [?19] -> [?20]
  [?20] -> [?19]

f :?27: (g :?28: (_ :?29: Nat) -> Nat) -> (z :?30: Nat) -> (h :?31: (_ :?32: Nat) -> Nat) -> (w :?33: Nat) -> Nat
  [] -> [?28,?31,?34,?37,?40,?41,!R]
  [?27] -> [?14]
  [?29] -> [?35]
  [?30] -> [?36]
  [?32] -> [?38]
  [?33] -> [?39]
  [?35] -> [?29]
  [?35/10] -> [?36,?42]
  [?36] -> [?30]
  [?38] -> [?32]
  [?38/12] -> [?39,?43]
  [?39] -> [?33]

id :?15: (_ :?16: Nat) -> Nat
  [?15] -> [?17]
  [?16] -> [?17]
  [?17] -> [?16]

main :!R: Nat
  [] -> [?12/34,?12/35,?13/34,?13/35,?14,?15/34,?15/35,?16/34,?16/35,?17/34,?17/35,?18/34,?18/35,?19/34,?20/34,?21/34,?21/35,?22/34,?22/35,?23/34,?23/35,?24/34,?25/34,?26/34,?28/35,?29/35,?30/35,?31/35,?34/35,?35/35,?36/35,?37/35,?40/35,?41/35,?42/35,?44/34,?45/34,?46/34,?47/34,?48/34,?49/34,?50/34,?51/34,?52,?53/34,?54/34,?55/34,?56/34,?57/34,?58/34,?59/34,?60/34,?61,?63/35,?64/35,?65/35,?66/35,?67/35,?69,?70,!R]
  [?19/35] -> [?20/35,?32/35]
  [?20/35] -> [?19/35]
  [?27/35] -> [?14/35]
  [?32/35] -> [?19/35,?38/35]
  [?33/35] -> [?39/35,?62/35,?68/35]
  [?38/35] -> [?32/35,?39/35,?43/35]
  [?39/35] -> [?33/35]
  [?52/34] -> [?14/34]
  [?61/35] -> [?27/35]

test_1 :?52: Nat
  [] -> [?44,?53,?54,!R]
  [?15/18,?45/17] -> [?17/18]
  [?16/18] -> [?46/17]
  [?16/18,?45/17] -> [?17/18]
  [?17/18,?45/17] -> [?16/18]
  [?19/23] -> [?46/22]
  [?19/23,?45/22] -> [?20/23]
  [?20/23,?45/22] -> [?19/23]
  [?44/17] -> [?48/17]
  [?44/22] -> [?48/22]
  [?45/17] -> [?15,?48/17,?56]
  [?45/22] -> [?12/23,?13/23,?18,?21/23,?22/23,?23/23,?48/22,?60]
  [?46/17] -> [?16/18,?49/17]
  [?46/22] -> [?19/23,?49/22]
  [?47/17] -> [?12,?13,?50/17,?55,?57,?58]
  [?47/22] -> [?12/24,?13/24,?24,?25/24,?26/24,?50/22,?59]
  [?48/17] -> [?45/17]
  [?48/22] -> [?45/22]
  [?49/17] -> [?46/17,?50/17,?51/17]
  [?49/22] -> [?46/22,?50/22,?51/22]
  [?50/17] -> [?47/17]
  [?50/22] -> [?47/22]
  [?52] -> [?14]

test_2 :?61: Nat
  [] -> [?12/30,?13/30,?15,?18,?21/30,?22/30,?23/30,?28/25,?31/25,?34/25,?37/25,?40/25,?41/25,?63,?65,!R]
  [?15/26] -> [?17/26]
  [?16/26] -> [?17/26,?29/25]
  [?17/26] -> [?16/26]
  [?19/30] -> [?20/30,?32/25]
  [?20/30] -> [?19/30]
  [?27/25] -> [?14/25]
  [?29/25] -> [?16/26,?35/25]
  [?30/25] -> [?12,?13,?36/25,?64,?66,?67]
  [?32/25] -> [?19/30,?38/25]
  [?33/25] -> [?12,?13,?39/25,?62,?68]
  [?35/25] -> [?29/25,?36/25,?42/25]
  [?36/25] -> [?30/25]
  [?38/25] -> [?32/25,?39/25,?43/25]
  [?39/25] -> [?33/25]
  [?61] -> [?27]

two :?24: Nat
  [] -> [?12,?13,?25,?26,!R]


### Constraints ###

[] -> [?12,?12/30,?12/34,?12/35,?13,?13/30,?13/34,?13/35,?14,?15,?15/34,?15/35,?16/34,?16/35,?17/34,?17/35,?18,?18/34,?18/35,?19/34,?20/34,?21,?21/30,?21/34,?21/35,?22,?22/30,?22/34,?22/35,?23,?23/30,?23/34,?23/35,?24/34,?25,?25/34,?26,?26/34,?28,?28/25,?28/35,?29/35,?30/35,?31,?31/25,?31/35,?34,?34/25,?34/35,?35/35,?36/35,?37,?37/25,?37/35,?40,?40/25,?40/35,?41,?41/25,?41/35,?42/35,?44,?44/34,?45/34,?46/34,?47/34,?48/34,?49/34,?50/34,?51/34,?52,?53,?53/34,?54,?54/34,?55/34,?56/34,?57/34,?58/34,?59/34,?60/34,?61,?63,?63/35,?64/35,?65,?65/35,?66/35,?67/35,?69,?70,!R]
[?15] -> [?17]
[?15/18,?45/17] -> [?17/18]
[?15/26] -> [?17/26]
[?16] -> [?17]
[?16/18] -> [?46/17]
[?16/18,?45/17] -> [?17/18]
[?16/26] -> [?17/26,?29/25]
[?17] -> [?16]
[?17/18,?45/17] -> [?16/18]
[?17/26] -> [?16/26]
[?19] -> [?20]
[?19/23] -> [?46/22]
[?19/23,?45/22] -> [?20/23]
[?19/30] -> [?20/30,?32/25]
[?19/35] -> [?20/35,?32/35]
[?20] -> [?19]
[?20/23,?45/22] -> [?19/23]
[?20/30] -> [?19/30]
[?20/35] -> [?19/35]
[?27] -> [?14]
[?27/25] -> [?14/25]
[?27/35] -> [?14/35]
[?29] -> [?35]
[?29/25] -> [?16/26,?35/25]
[?30] -> [?36]
[?30/25] -> [?12,?13,?36/25,?64,?66,?67]
[?32] -> [?38]
[?32/25] -> [?19/30,?38/25]
[?32/35] -> [?19/35,?38/35]
[?33] -> [?39]
[?33/25] -> [?12,?13,?39/25,?62,?68]
[?33/35] -> [?39/35,?62/35,?68/35]
[?35] -> [?29]
[?35/10] -> [?36,?42]
[?35/25] -> [?29/25,?36/25,?42/25]
[?36] -> [?30]
[?36/25] -> [?30/25]
[?38] -> [?32]
[?38/12] -> [?39,?43]
[?38/25] -> [?32/25,?39/25,?43/25]
[?38/35] -> [?32/35,?39/35,?43/35]
[?39] -> [?33]
[?39/25] -> [?33/25]
[?39/35] -> [?33/35]
[?44] -> [?48]
[?44/17] -> [?48/17]
[?44/22] -> [?48/22]
[?45] -> [?48]
[?45/17] -> [?15,?48/17,?56]
[?45/22] -> [?12/23,?13/23,?18,?21/23,?22/23,?23/23,?48/22,?60]
[?46] -> [?49]
[?46/17] -> [?16/18,?49/17]
[?46/22] -> [?19/23,?49/22]
[?47] -> [?50]
[?47/17] -> [?12,?13,?50/17,?55,?57,?58]
[?47/22] -> [?12/24,?13/24,?24,?25/24,?26/24,?50/22,?59]
[?48] -> [?45]
[?48/17] -> [?45/17]
[?48/22] -> [?45/22]
[?49] -> [?46]
[?49/14] -> [?50,?51]
[?49/17] -> [?46/17,?50/17,?51/17]
[?49/22] -> [?46/22,?50/22,?51/22]
[?50] -> [?47]
[?50/17] -> [?47/17]
[?50/22] -> [?47/22]
[?52] -> [?14]
[?52/34] -> [?14/34]
[?61] -> [?27]
[?61/35] -> [?27/35]

### Solution ###

[?12,?12/30,?12/34,?12/35,?13,?13/30,?13/34,?13/35,?14,?15,?15/34,?15/35,?16,?16/34,?16/35,?17,?17/34,?17/35,?18,?18/34,?18/35,?19/34,?20/34,?21,?21/30,?21/34,?21/35,?22,?22/30,?22/34,?22/35,?23,?23/30,?23/34,?23/35,?24/34,?25,?25/34,?26,?26/34,?27,?28,?28/25,?28/35,?29/35,?30/35,?31,?31/25,?31/35,?34,?34/25,?34/35,?35/35,?36/35,?37,?37/25,?37/35,?40,?40/25,?40/35,?41,?41/25,?41/35,?42/35,?44,?44/34,?45,?45/34,?46/34,?47/34,?48,?48/34,?49/34,?50/34,?51/34,?52,?53,?53/34,?54,?54/34,?55/34,?56/34,?57/34,?58/34,?59/34,?60/34,?61,?63,?63/35,?64/35,?65,?65/35,?66/35,?67/35,?69,?70,!R]

### Annotated ###

Bool :I: *
Bool = (axiom)

True :I: Bool
True = (axiom)

False :I: Bool
False = (axiom)

Maybe :I: (_ :I: *) -> *
Maybe = (axiom)

Just :I: (a :I: *) -> (_ :I: a) -> *
Just = (axiom)

Nothing :I: (a :I: *) -> *
Nothing = (axiom)

Nat :I: *
Nat = (axiom)

Z :R: Nat
Z = (axiom)

S :R: (n :R: Nat) -> Nat
S = (axiom)

Plus :R: (x :R: Nat) -> (y :R: Nat) -> Nat
Plus = (axiom)

id :R: (_ :R: Nat) -> Nat
id = \y :R: Nat. y

const_3 :R: (_ :I: Nat) -> Nat
const_3 = \_ :I: Nat. 3

two :I: Nat
two = 2

f :R: (g :R: (_ :I: Nat) -> Nat) -> (z :I: Nat) -> (h :R: (_ :I: Nat) -> Nat) -> (w :I: Nat) -> Nat
f = \g :R: (_ :I: Nat) -> Nat. \z :I: Nat. \h :R: (_ :I: Nat) -> Nat. \w :I: Nat. (Plus -R- (g -I- z) -R- (h -I- w))

apply :R: (f :R: (_ :I: Nat) -> Nat) -> (_ :I: Nat) -> Nat
apply = \f :R: (_ :I: Nat) -> Nat. \x :I: Nat. (f -I- x)

test_1 :R: Nat
test_1 = (Plus -R- (apply -I- id -I- 2) -R- (apply -I- const_3 -I- two))

test_2 :R: Nat
test_2 = (f -R- id -I- 2 -R- const_3 -I- 1)

main :R: Nat
main = (Plus -R- test_1 -R- test_2)

### Pruned ###

Z = (axiom)

S = (axiom)

Plus = (axiom)

id = \y. y

const_3 = 3

f = \g. \h. (Plus g h)

apply = \f. f

test_1 = (Plus apply apply)

test_2 = (f id const_3)

main = (Plus test_1 test_2)

