-- vim: ft=agda

### Desugared ###

Bool : *
Bool = (axiom)

True : Bool
True = (axiom)

False : Bool
False = (axiom)

Maybe : (_ : *) -> *
Maybe = (axiom)

Just : (a : *) -> (_ : a) -> *
Just = (axiom)

Nothing : (a : *) -> *
Nothing = (axiom)

Nat : *
Nat = (axiom)

Z : Nat
Z = (axiom)

S : (n  -R-  Nat) -> Nat
S = (axiom)

Plus : (x  -R-  Nat) -> (y  -R-  Nat) -> Nat
Plus = (axiom)

id : (_ : Nat) -> Nat
id = \y : Nat. y

const_3 : (_ : Nat) -> Nat
const_3 = \_ : Nat. 3

two : Nat
two = 2

f : (g : (_ : Nat) -> Nat) -> (z : Nat) -> (h : (_ : Nat) -> Nat) -> (w : Nat) -> Nat
f = \g : (_ : Nat) -> Nat. \z : Nat. \h : (_ : Nat) -> Nat. \w : Nat. (Plus (g z) (h w))

apply : (f : (_ : Nat) -> Nat) -> (_ : Nat) -> Nat
apply = \f : (_ : Nat) -> Nat. \x : Nat. (f x)

test_1 : Nat
test_1 = (Plus (apply id 2) (apply const_3 two))

test_2 : Nat
test_2 = (f id 2 const_3 1)

main  -R-  Nat
main = (Plus test_1 test_2)

### Metaified ###

Bool :?1: *
Bool = (axiom)

True :?2: Bool
True = (axiom)

False :?3: Bool
False = (axiom)

Maybe :?4: (_ :?5: *) -> *
Maybe = (axiom)

Just :?6: (a :?7: *) -> (_ :?8: a) -> *
Just = (axiom)

Nothing :?9: (a :?10: *) -> *
Nothing = (axiom)

Nat :?11: *
Nat = (axiom)

Z :?12: Nat
Z = (axiom)

S :?13: (n :!R: Nat) -> Nat
S = (axiom)

Plus :?14: (x :!R: Nat) -> (y :!R: Nat) -> Nat
Plus = (axiom)

id :?15: (_ :?16: Nat) -> Nat
id = \y :?17: Nat. y

const_3 :?18: (_ :?19: Nat) -> Nat
const_3 = \_ :?20: Nat. 3

two :?27: Nat
two = 2

f :?32: (g :?33: (_ :?34: Nat) -> Nat) -> (z :?35: Nat) -> (h :?36: (_ :?37: Nat) -> Nat) -> (w :?38: Nat) -> Nat
f = \g :?39: (_ :?40: Nat) -> Nat. \z :?41: Nat. \h :?42: (_ :?43: Nat) -> Nat. \w :?44: Nat. (Plus -?48- (g -?50- z) -?46- (h -?52- w))

apply :?53: (f :?54: (_ :?55: Nat) -> Nat) -> (_ :?56: Nat) -> Nat
apply = \f :?57: (_ :?58: Nat) -> Nat. \x :?59: Nat. (f -?61- x)

test_1 :?62: Nat
test_1 = (Plus -?66- (apply -?70- id -?68- 2) -?64- (apply -?78- const_3 -?76- two))

test_2 :?79: Nat
test_2 = (f -?87- id -?85- 2 -?83- const_3 -?81- 1)

main :!R: Nat
main = (Plus -?97- test_1 -?95- test_2)

### Inferred definitions ###

Bool :?1: *

False :?3: Bool

Just :?6: (a :?7: *) -> (_ :?8: a) -> *

Maybe :?4: (_ :?5: *) -> *

Nat :?11: *

Nothing :?9: (a :?10: *) -> *

Plus :?14: (x :!R: Nat) -> (y :!R: Nat) -> Nat

S :?13: (n :!R: Nat) -> Nat

True :?2: Bool

Z :?12: Nat

apply :?53: (f :?54: (_ :?55: Nat) -> Nat) -> (_ :?56: Nat) -> Nat
  [] -> [?54,?57,!R]
  [?55] -> [?58]
  [?56] -> [?59]
  [?58] -> [?55,?60]
  [?58_14] -> [?58,?59,?61]
  [?59] -> [?56]

const_3 :?18: (_ :?19: Nat) -> Nat
  [] -> [?12,?13,?21,?22,?23,?24,?25,?26,!R]
  [?19] -> [?20]
  [?20] -> [?19]

f :?32: (g :?33: (_ :?34: Nat) -> Nat) -> (z :?35: Nat) -> (h :?36: (_ :?37: Nat) -> Nat) -> (w :?38: Nat) -> Nat
  [] -> [?14,?33,?36,?39,?42,?45,?46,?47,?48,!R]
  [?34] -> [?40]
  [?35] -> [?41]
  [?37] -> [?43]
  [?38] -> [?44]
  [?40] -> [?34,?49]
  [?40_10] -> [?40,?41,?50]
  [?41] -> [?35]
  [?43] -> [?37,?51]
  [?43_12] -> [?43,?44,?52]
  [?44] -> [?38]

id :?15: (_ :?16: Nat) -> Nat
  [] -> [?16,?17,!R]

main :!R: Nat
  [] -> [?12_34,?12_35,?13_34,?13_35,?14,?14_34,?14_35,?15_34,?15_35,?16_34,?16_35,?17_34,?17_35,?18_34,?18_35,?19_34,?20_34,?21_34,?21_35,?22_34,?22_35,?23_34,?23_35,?24_34,?24_35,?25_34,?25_35,?26_34,?26_35,?27_34,?28_34,?29_34,?30_34,?31_34,?32_35,?33_35,?34_35,?35_35,?36_35,?39_35,?40_35,?41_35,?42_35,?45_35,?46_35,?47_35,?48_35,?49_35,?50_35,?53_34,?54_34,?55_34,?56_34,?57_34,?58_34,?59_34,?60_34,?61_34,?62,?63_34,?64_34,?65_34,?66_34,?67_34,?68_34,?69_34,?70_34,?71_34,?72_34,?73_34,?74_34,?75_34,?76_34,?77_34,?78_34,?79,?82_35,?83_35,?84_35,?85_35,?86_35,?87_35,?88_35,?89_35,?90_35,?91_35,?94,?95,?96,?97,!R]
  [?19_35] -> [?19_35,?20_35,?37_35]
  [?20_35] -> [?19_35]
  [?37_35] -> [?19_35,?37_35,?43_35]
  [?38_35] -> [?38_35,?44_35,?80_35,?81_35,?92_35,?93_35]
  [?43_35] -> [?37_35,?43_35,?44_35,?51_35,?52_35]
  [?44_35] -> [?38_35]

test_1 :?62: Nat
  [] -> [?12,?12_23,?13,?13_23,?14,?15,?16,?16_18,?17_18,?18,?21_23,?22_23,?23_23,?24_23,?25_23,?26_23,?53,?54,?54_17,?54_22,?55,?55_17,?56,?56_17,?57_17,?57_22,?58_17,?59_17,?60_17,?61_17,?63,?64,?65,?66,?67,?68,?69,?70,?71,?72,?73,?74,?75,?77,?78,!R]
  [?19_23] -> [?19,?20_23,?55_22]
  [?20_23] -> [?19_23]
  [?55_22] -> [?19_23,?58_22]
  [?56_22] -> [?12_24,?13_24,?27,?28_24,?29_24,?30_24,?31_24,?59_22,?76]
  [?58_22] -> [?55_22,?58_22,?59_22,?60_22,?61_22]
  [?59_22] -> [?56_22]

test_2 :?79: Nat
  [] -> [?12,?12_30,?13,?13_30,?14_25,?15,?16,?16_26,?17_26,?18,?21_30,?22_30,?23_30,?24_30,?25_30,?26_30,?32,?33,?33_25,?34,?34_25,?35,?35_25,?36,?36_25,?39_25,?40_25,?41_25,?42_25,?45_25,?46_25,?47_25,?48_25,?49_25,?50_25,?82,?83,?84,?85,?86,?87,?88,?89,?90,?91,!R]
  [?19_30] -> [?19,?20_30,?37_25]
  [?20_30] -> [?19_30]
  [?37_25] -> [?19_30,?37,?43_25]
  [?38] -> [?80]
  [?38_25] -> [?38,?44_25,?81,?92,?93]
  [?43_25] -> [?37_25,?43_25,?44_25,?51_25,?52_25]
  [?44_25] -> [?38_25]

two :?27: Nat
  [] -> [?12,?13,?28,?29,?30,?31,!R]


### Constraints ###

[] -> [?12,?12_23,?12_30,?12_34,?12_35,?13,?13_23,?13_30,?13_34,?13_35,?14,?14_25,?14_34,?14_35,?15,?15_34,?15_35,?16,?16_18,?16_26,?16_34,?16_35,?17,?17_18,?17_26,?17_34,?17_35,?18,?18_34,?18_35,?19_34,?20_34,?21,?21_23,?21_30,?21_34,?21_35,?22,?22_23,?22_30,?22_34,?22_35,?23,?23_23,?23_30,?23_34,?23_35,?24,?24_23,?24_30,?24_34,?24_35,?25,?25_23,?25_30,?25_34,?25_35,?26,?26_23,?26_30,?26_34,?26_35,?27_34,?28,?28_34,?29,?29_34,?30,?30_34,?31,?31_34,?32,?32_35,?33,?33_25,?33_35,?34,?34_25,?34_35,?35,?35_25,?35_35,?36,?36_25,?36_35,?39,?39_25,?39_35,?40_25,?40_35,?41_25,?41_35,?42,?42_25,?42_35,?45,?45_25,?45_35,?46,?46_25,?46_35,?47,?47_25,?47_35,?48,?48_25,?48_35,?49_25,?49_35,?50_25,?50_35,?53,?53_34,?54,?54_17,?54_22,?54_34,?55,?55_17,?55_34,?56,?56_17,?56_34,?57,?57_17,?57_22,?57_34,?58_17,?58_34,?59_17,?59_34,?60_17,?60_34,?61_17,?61_34,?62,?63,?63_34,?64,?64_34,?65,?65_34,?66,?66_34,?67,?67_34,?68,?68_34,?69,?69_34,?70,?70_34,?71,?71_34,?72,?72_34,?73,?73_34,?74,?74_34,?75,?75_34,?76_34,?77,?77_34,?78,?78_34,?79,?82,?82_35,?83,?83_35,?84,?84_35,?85,?85_35,?86,?86_35,?87,?87_35,?88,?88_35,?89,?89_35,?90,?90_35,?91,?91_35,?94,?95,?96,?97,!R]
[?19] -> [?20]
[?19_23] -> [?19,?20_23,?55_22]
[?19_30] -> [?19,?20_30,?37_25]
[?19_35] -> [?19_35,?20_35,?37_35]
[?20] -> [?19]
[?20_23] -> [?19_23]
[?20_30] -> [?19_30]
[?20_35] -> [?19_35]
[?34] -> [?40]
[?35] -> [?41]
[?37] -> [?43]
[?37_25] -> [?19_30,?37,?43_25]
[?37_35] -> [?19_35,?37_35,?43_35]
[?38] -> [?44,?80]
[?38_25] -> [?38,?44_25,?81,?92,?93]
[?38_35] -> [?38_35,?44_35,?80_35,?81_35,?92_35,?93_35]
[?40] -> [?34,?49]
[?40_10] -> [?40,?41,?50]
[?41] -> [?35]
[?43] -> [?37,?51]
[?43_12] -> [?43,?44,?52]
[?43_25] -> [?37_25,?43_25,?44_25,?51_25,?52_25]
[?43_35] -> [?37_35,?43_35,?44_35,?51_35,?52_35]
[?44] -> [?38]
[?44_25] -> [?38_25]
[?44_35] -> [?38_35]
[?55] -> [?58]
[?55_22] -> [?19_23,?58_22]
[?56] -> [?59]
[?56_22] -> [?12_24,?13_24,?27,?28_24,?29_24,?30_24,?31_24,?59_22,?76]
[?58] -> [?55,?60]
[?58_14] -> [?58,?59,?61]
[?58_22] -> [?55_22,?58_22,?59_22,?60_22,?61_22]
[?59] -> [?56]
[?59_22] -> [?56_22]

### Solution ###

[?12,?12_23,?12_30,?12_34,?12_35,?13,?13_23,?13_30,?13_34,?13_35,?14,?14_25,?14_34,?14_35,?15,?15_34,?15_35,?16,?16_18,?16_26,?16_34,?16_35,?17,?17_18,?17_26,?17_34,?17_35,?18,?18_34,?18_35,?19_34,?20_34,?21,?21_23,?21_30,?21_34,?21_35,?22,?22_23,?22_30,?22_34,?22_35,?23,?23_23,?23_30,?23_34,?23_35,?24,?24_23,?24_30,?24_34,?24_35,?25,?25_23,?25_30,?25_34,?25_35,?26,?26_23,?26_30,?26_34,?26_35,?27_34,?28,?28_34,?29,?29_34,?30,?30_34,?31,?31_34,?32,?32_35,?33,?33_25,?33_35,?34,?34_25,?34_35,?35,?35_25,?35_35,?36,?36_25,?36_35,?39,?39_25,?39_35,?40,?40_25,?40_35,?41,?41_25,?41_35,?42,?42_25,?42_35,?45,?45_25,?45_35,?46,?46_25,?46_35,?47,?47_25,?47_35,?48,?48_25,?48_35,?49,?49_25,?49_35,?50_25,?50_35,?53,?53_34,?54,?54_17,?54_22,?54_34,?55,?55_17,?55_34,?56,?56_17,?56_34,?57,?57_17,?57_22,?57_34,?58,?58_17,?58_34,?59,?59_17,?59_34,?60,?60_17,?60_34,?61_17,?61_34,?62,?63,?63_34,?64,?64_34,?65,?65_34,?66,?66_34,?67,?67_34,?68,?68_34,?69,?69_34,?70,?70_34,?71,?71_34,?72,?72_34,?73,?73_34,?74,?74_34,?75,?75_34,?76_34,?77,?77_34,?78,?78_34,?79,?82,?82_35,?83,?83_35,?84,?84_35,?85,?85_35,?86,?86_35,?87,?87_35,?88,?88_35,?89,?89_35,?90,?90_35,?91,?91_35,?94,?95,?96,?97,!R]

### Annotated ###

Bool :I: *
Bool = (axiom)

True :I: Bool
True = (axiom)

False :I: Bool
False = (axiom)

Maybe :I: (_ :I: *) -> *
Maybe = (axiom)

Just :I: (a :I: *) -> (_ :I: a) -> *
Just = (axiom)

Nothing :I: (a :I: *) -> *
Nothing = (axiom)

Nat :I: *
Nat = (axiom)

Z :R: Nat
Z = (axiom)

S :R: (n :R: Nat) -> Nat
S = (axiom)

Plus :R: (x :R: Nat) -> (y :R: Nat) -> Nat
Plus = (axiom)

id :R: (_ :R: Nat) -> Nat
id = \y :R: Nat. y

const_3 :R: (_ :I: Nat) -> Nat
const_3 = \_ :I: Nat. 3

two :I: Nat
two = 2

f :R: (g :R: (_ :R: Nat) -> Nat) -> (z :R: Nat) -> (h :R: (_ :I: Nat) -> Nat) -> (w :I: Nat) -> Nat
f = \g :R: (_ :R: Nat) -> Nat. \z :R: Nat. \h :R: (_ :I: Nat) -> Nat. \w :I: Nat. (Plus -R- (g -I- z) -R- (h -I- w))

apply :R: (f :R: (_ :R: Nat) -> Nat) -> (_ :R: Nat) -> Nat
apply = \f :R: (_ :R: Nat) -> Nat. \x :R: Nat. (f -I- x)

test_1 :R: Nat
test_1 = (Plus -R- (apply -R- id -R- 2) -R- (apply -R- const_3 -I- two))

test_2 :R: Nat
test_2 = (f -R- id -R- 2 -R- const_3 -I- 1)

main :R: Nat
main = (Plus -R- test_1 -R- test_2)

### Pruned ###

Z = (axiom)

S = (axiom)

Plus = (axiom)

id = \y. y

const_3 = 3

f = \g. \z. \h. (Plus (g ____) h)

apply = \f. \x. (f ____)

test_1 = (Plus (apply id 2) (apply const_3 ____))

test_2 = (f id 2 const_3)

main = (Plus test_1 test_2)

