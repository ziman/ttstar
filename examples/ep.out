-- vim: ft=agda

### Desugared ###

postulate T : *

postulate A : T

postulate B : T

postulate Op : (x  -R-  T) -> (y  -R-  T) -> T

id : (__ : T) -> T 
  pat (y : T).
    id y  =  y

constA : (__ : T) -> T 
  pat (x : T).
    constA x  =  A

apply : (__ : (__ : T) -> T) -> (__ : T) -> T 
  pat (f : (__ : T) -> T) (x : T).
    apply f x  =  f x

test1 : T 
  test1  =  (apply : (__ : (__ : T) -> T) -> (__ : T) -> T) id B

test2 : T 
  test2  =  (apply : (__ : (__ : T) -> T) -> (__ : T) -> T) constA B

main  -R-  T 
  main  =  Op test1 test2

### Metaified ###

postulate T :?1: *

postulate A :?2: T

postulate B :?3: T

postulate Op :?4: (x :!R: T) -> (y :!R: T) -> T

id :?5: (__ :?6: T) -> T 
  pat (y :?7: T).
    id -?8- y  =  y

constA :?9: (__ :?10: T) -> T 
  pat (x :?11: T).
    constA -?12- x  =  A

apply :?13: (__ :?14: (__ :?15: T) -> T) -> (__ :?16: T) -> T 
  pat (f :?17: (__ :?18: T) -> T) (x :?19: T).
    apply -?21- f -?20- x  =  f -?22- x

test1 :?23: T 
  test1  =  (apply : (__ :?26: (__ :?27: T) -> T) -> (__ :?28: T) -> T) -?25- id -?24- B

test2 :?29: T 
  test2  =  (apply : (__ :?32: (__ :?33: T) -> T) -> (__ :?34: T) -> T) -?31- constA -?30- B

main :!R: T 
  main  =  Op -?36- test1 -?35- test2

### Inferred definitions ###

postulate A :?2: T

postulate B :?3: T

postulate Op :?4: (x :!R: T) -> (y :!R: T) -> T

postulate T :?1: *

apply :?13: (__ :?14: (__ :?15: T) -> T) -> (__ :?16: T) -> T 
  pat (f :?17: (__ :?18: T) -> T) (x :?19: T).
    apply -?21- f -?20- x  =  f -?22- x
  [] -> [?14,?17,?21,!R]
  [?15] -> [?18]
  [?16] -> [?20]
  [?18] -> [?15,?19,?22]
  [?19] -> [?16]
  [?20] -> [?16]
  [?22] -> [?18]

constA :?9: (__ :?10: T) -> T 
  pat (x :?11: T).
    constA -?12- x  =  A
  [] -> [?2,!R]
  [?10] -> [?12]
  [?11] -> [?10]
  [?12] -> [?10]

id :?5: (__ :?6: T) -> T 
  pat (y :?7: T).
    id -?8- y  =  y
  [] -> [?6,?7,?8,!R]

main :!R: T 
  main  =  Op -?36- test1 -?35- test2
  [] -> [?4,?23,?29,?35,?36,!R]

test1 :?23: T 
  test1  =  (apply : (__ :?26: (__ :?27: T) -> T) -> (__ :?28: T) -> T) -?25- id -?24- B
  [] -> [?5,?25,?26,?38,?41,?45,!R]
  [?6] -> [?39]
  [?24] -> [?40]
  [?27] -> [?39]
  [?28] -> [?40]
  [?39] -> [?6,?27,?42]
  [?40] -> [?3,?24,?28,?44]
  [?42] -> [?39,?43,?46]
  [?43] -> [?40]
  [?44] -> [?40]
  [?46] -> [?42]

test2 :?29: T 
  test2  =  (apply : (__ :?32: (__ :?33: T) -> T) -> (__ :?34: T) -> T) -?31- constA -?30- B
  [] -> [?9,?31,?32,?48,?51,?55,!R]
  [?10] -> [?49]
  [?30] -> [?50]
  [?33] -> [?49]
  [?34] -> [?50]
  [?49] -> [?10,?33,?52]
  [?50] -> [?3,?30,?34,?54]
  [?52] -> [?49,?53,?56]
  [?53] -> [?50]
  [?54] -> [?50]
  [?56] -> [?52]


### Constraints ###

[] -> [?2,?4,?5,?6,?7,?8,?9,?14,?17,?21,?23,?25,?26,?29,?31,?32,?35,?36,?38,?41,?45,?48,?51,?55,!R]
[?6] -> [?39]
[?10] -> [?12,?49]
[?11] -> [?10]
[?12] -> [?10]
[?15] -> [?18]
[?16] -> [?20]
[?18] -> [?15,?19,?22]
[?19] -> [?16]
[?20] -> [?16]
[?22] -> [?18]
[?24] -> [?40]
[?27] -> [?39]
[?28] -> [?40]
[?30] -> [?50]
[?33] -> [?49]
[?34] -> [?50]
[?39] -> [?6,?27,?42]
[?40] -> [?3,?24,?28,?44]
[?42] -> [?39,?43,?46]
[?43] -> [?40]
[?44] -> [?40]
[?46] -> [?42]
[?49] -> [?10,?33,?52]
[?50] -> [?3,?30,?34,?54]
[?52] -> [?49,?53,?56]
[?53] -> [?50]
[?54] -> [?50]
[?56] -> [?52]

### Solution ###

[?2,?3,?4,?5,?6,?7,?8,?9,?14,?17,?21,?23,?24,?25,?26,?27,?28,?29,?31,?32,?35,?36,?38,?39,?40,?41,?42,?43,?44,?45,?46,?48,?51,?55,!R]

### Annotated ###

postulate T :E: *

postulate A :R: T

postulate B :R: T

postulate Op :R: (x :R: T) -> (y :R: T) -> T

id :R: (__ :R: T) -> T 
  pat (y :R: T).
    id -R- y  =  y

constA :R: (__ :E: T) -> T 
  pat (x :E: T).
    constA -E- x  =  A

apply :E: (__ :R: (__ :E: T) -> T) -> (__ :E: T) -> T 
  pat (f :R: (__ :E: T) -> T) (x :E: T).
    apply -R- f -E- x  =  f -E- x

test1 :R: T 
  test1  =  (apply : (__ :R: (__ :R: T) -> T) -> (__ :R: T) -> T) -R- id -R- B

test2 :R: T 
  test2  =  (apply : (__ :R: (__ :E: T) -> T) -> (__ :E: T) -> T) -R- constA -E- B

main :R: T 
  main  =  Op -R- test1 -R- test2

### Specialised ###

postulate T :!E: *

postulate A :!R: T

postulate B :!R: T

postulate Op :!R: (x :!R: T) -> (y :!R: T) -> T

id :!R: (__ :!R: T) -> T 
  pat (y :!R: T).
    id -!R- y  =  y

constA :!R: (__ :!E: T) -> T 
  pat (x :!E: T).
    constA -!E- x  =  A

apply :!E: (__ :!R: (__ :!E: T) -> T) -> (__ :!E: T) -> T 
  pat (f :!R: (__ :!E: T) -> T) (x :!E: T).
    apply -!R- f -!E- x  =  f -!E- x

apply_REE :?1: (__ :!R: (__ :!E: T) -> T) -> (__ :!E: T) -> T 
  pat (f :?2: (__ :?3: T) -> T) (x :?4: T).
    apply_REE -?6- f -?5- x  =  f -?7- x

apply_RRR :?8: (__ :!R: (__ :!R: T) -> T) -> (__ :!R: T) -> T 
  pat (f :?9: (__ :?10: T) -> T) (x :?11: T).
    apply_RRR -?13- f -?12- x  =  f -?14- x

test1 :!R: T 
  test1  =  apply_RRR -!R- id -!R- B

test2 :!R: T 
  test2  =  apply_REE -!R- constA -!E- B

main :!R: T 
  main  =  Op -!R- test1 -!R- test2

### Inferred definitions ###

postulate A :!R: T

postulate B :!R: T

postulate Op :!R: (x :!R: T) -> (y :!R: T) -> T

postulate T :!E: *

apply :!E: (__ :!R: (__ :!E: T) -> T) -> (__ :!E: T) -> T 
  pat (f :!R: (__ :!E: T) -> T) (x :!E: T).
    apply -!R- f -!E- x  =  f -!E- x
  [!E] -> [!E]

constA :!R: (__ :!E: T) -> T 
  pat (x :!E: T).
    constA -!E- x  =  A
  [!E] -> [!E]

id :!R: (__ :!R: T) -> T 
  pat (y :!R: T).
    id -!R- y  =  y

main :!R: T 
  main  =  Op -!R- test1 -!R- test2

test1 :!R: T 
  test1  =  apply_RRR -!R- id -!R- B
  [] -> [?8,!R]

test2 :!R: T 
  test2  =  apply_REE -!R- constA -!E- B
  [] -> [?1,!R]
  [!E] -> [!E]

apply_REE :?1: (__ :!R: (__ :!E: T) -> T) -> (__ :!E: T) -> T 
  pat (f :?2: (__ :?3: T) -> T) (x :?4: T).
    apply_REE -?6- f -?5- x  =  f -?7- x
  [] -> [?2,?6,!R]
  [?3] -> [?4,?7,!E]
  [?4] -> [!E]
  [?5] -> [!E]
  [?7] -> [?3]
  [!E] -> [?3,?5]

apply_RRR :?8: (__ :!R: (__ :!R: T) -> T) -> (__ :!R: T) -> T 
  pat (f :?9: (__ :?10: T) -> T) (x :?11: T).
    apply_RRR -?13- f -?12- x  =  f -?14- x
  [] -> [?9,?10,?11,?12,?13,?14,!R]


### Constraints ###

[] -> [?1,?2,?6,?8,?9,?10,?11,?12,?13,?14,!R]
[?3] -> [?4,?7,!E]
[?4] -> [!E]
[?5] -> [!E]
[?7] -> [?3]
[!E] -> [?3,?5,!E]

### Solution ###

[?1,?2,?6,?8,?9,?10,?11,?12,?13,?14,!R]

### Annotated ###

postulate T :E: *

postulate A :R: T

postulate B :R: T

postulate Op :R: (x :R: T) -> (y :R: T) -> T

id :R: (__ :R: T) -> T 
  pat (y :R: T).
    id -R- y  =  y

constA :R: (__ :E: T) -> T 
  pat (x :E: T).
    constA -E- x  =  A

apply :E: (__ :R: (__ :E: T) -> T) -> (__ :E: T) -> T 
  pat (f :R: (__ :E: T) -> T) (x :E: T).
    apply -R- f -E- x  =  f -E- x

apply_REE :R: (__ :R: (__ :E: T) -> T) -> (__ :E: T) -> T 
  pat (f :R: (__ :E: T) -> T) (x :E: T).
    apply_REE -R- f -E- x  =  f -E- x

apply_RRR :R: (__ :R: (__ :R: T) -> T) -> (__ :R: T) -> T 
  pat (f :R: (__ :R: T) -> T) (x :R: T).
    apply_RRR -R- f -R- x  =  f -R- x

test1 :R: T 
  test1  =  apply_RRR -R- id -R- B

test2 :R: T 
  test2  =  apply_REE -R- constA -E- B

main :R: T 
  main  =  Op -R- test1 -R- test2

### Specialised ###

postulate T :!E: *

postulate A :!R: T

postulate B :!R: T

postulate Op :!R: (x :!R: T) -> (y :!R: T) -> T

id :!R: (__ :!R: T) -> T 
  pat (y :!R: T).
    id -!R- y  =  y

constA :!R: (__ :!E: T) -> T 
  pat (x :!E: T).
    constA -!E- x  =  A

apply :!E: (__ :!R: (__ :!E: T) -> T) -> (__ :!E: T) -> T 
  pat (f :!R: (__ :!E: T) -> T) (x :!E: T).
    apply -!R- f -!E- x  =  f -!E- x

apply_REE :!R: (__ :!R: (__ :!E: T) -> T) -> (__ :!E: T) -> T 
  pat (f :!R: (__ :!E: T) -> T) (x :!E: T).
    apply_REE -!R- f -!E- x  =  f -!E- x

apply_RRR :!R: (__ :!R: (__ :!R: T) -> T) -> (__ :!R: T) -> T 
  pat (f :!R: (__ :!R: T) -> T) (x :!R: T).
    apply_RRR -!R- f -!R- x  =  f -!R- x

test1 :!R: T 
  test1  =  apply_RRR -!R- id -!R- B

test2 :!R: T 
  test2  =  apply_REE -!R- constA -!E- B

main :!R: T 
  main  =  Op -!R- test1 -!R- test2

### Final annotation ###

postulate T :E: *

postulate A :R: T

postulate B :R: T

postulate Op :R: (x :R: T) -> (y :R: T) -> T

id :R: (__ :R: T) -> T 
  pat (y :R: T).
    id -R- y  =  y

constA :R: (__ :E: T) -> T 
  pat (x :E: T).
    constA -E- x  =  A

apply :E: (__ :R: (__ :E: T) -> T) -> (__ :E: T) -> T 
  pat (f :R: (__ :E: T) -> T) (x :E: T).
    apply -R- f -E- x  =  f -E- x

apply_REE :R: (__ :R: (__ :E: T) -> T) -> (__ :E: T) -> T 
  pat (f :R: (__ :E: T) -> T) (x :E: T).
    apply_REE -R- f -E- x  =  f -E- x

apply_RRR :R: (__ :R: (__ :R: T) -> T) -> (__ :R: T) -> T 
  pat (f :R: (__ :R: T) -> T) (x :R: T).
    apply_RRR -R- f -R- x  =  f -R- x

test1 :R: T 
  test1  =  apply_RRR -R- id -R- B

test2 :R: T 
  test2  =  apply_REE -R- constA -E- B

main :R: T 
  main  =  Op -R- test1 -R- test2

### Verification ###

Verification successful.

### Pruned ###

postulate A

postulate B

postulate Op

id 
  pat (y).
    id y  =  y

constA 
  constA  =  A

apply_REE 
  pat (f).
    apply_REE f  =  f

apply_RRR 
  pat (f) (x).
    apply_RRR f x  =  f x

test1 
  test1  =  apply_RRR id B

test2 
  test2  =  apply_REE constA

main 
  main  =  Op test1 test2

### Normal forms ###

unerased:
  Op B A
erased:
  Op B A
