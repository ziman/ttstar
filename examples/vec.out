-- vim: ft=idris

### Desugared ###

  let
    postulate N : Type
    postulate Z : N
    postulate S : (x :R: N) -> N
    postulate Vec : (_x0 : N) -> (_x1 : Type) -> Type
    postulate Nil : (a : Type) -> Vec Z a
    postulate Cons : (a : Type) -> (n : N) -> (x :R: a) -> (xs :R: Vec n a) -> Vec (S n) a
    plus : (_x2 : N) -> (_x3 : N) -> N 
      n : N
        [plus] Z n = n
      m : N n : N
        [plus] (S m) n = S (plus m n)
    append : (a : Type) -> (m : N) -> (n : N) -> (xs : Vec m a) -> (ys : Vec n a) -> Vec (plus m n) a 
      a : Type n : N ys : Vec n a
        [append] a [Z] n (Nil [a]) ys = ys
      a : Type m : N n : N x : a xs : Vec m a ys : Vec n a
        [append] a ([S] m) n (Cons [a] [m] x xs) ys = Cons a (plus m n) x (append a m n xs ys)
    main : Vec 1 N = append N Z 1 (Nil N) (Cons N Z 4 (Nil N))
  in main

### Evarified ###

  let
    postulate N :1: Type
    postulate Z :2: N
    postulate S :3: (x :R: N) -> N
    postulate Vec :4: (_x0 :5: N) -> (_x1 :6: Type) -> Type
    postulate Nil :7: (a :8: Type) -> Vec -10- Z -9- a
    postulate Cons :11: (a :12: Type) -> (n :13: N) -> (x :R: a) -> (xs :R: Vec -15- n -14- a) -> Vec -17- (S -18- n) -16- a
    plus :19: (_x2 :20: N) -> (_x3 :21: N) -> N 
      n :22: N
        [plus] -24- Z -23- n = n
      m :25: N n :26: N
        [plus] -28- (S -29- m) -27- n = S -30- (plus -32- m -31- n)
    append :33: (a :34: Type) -> (m :35: N) -> (n :36: N) -> (xs :37: Vec -39- m -38- a) -> (ys :40: Vec -42- n -41- a) -> Vec -44- (plus -46- m -45- n) -43- a 
      a :47: Type n :48: N ys :49: Vec -51- n -50- a
        [append] -56- a -55- [Z] -54- n -53- (Nil -57- [a]) -52- ys = ys
      a :58: Type m :59: N n :60: N x :61: a xs :62: Vec -64- m -63- a ys :65: Vec -67- n -66- a
        [append] -72- a -71- ([S] -73- m) -70- n -69- (Cons -77- [a] -76- [m] -75- x -74- xs) -68- ys = Cons -81- a -80- (plus -83- m -82- n) -79- x -78- (append -88- a -87- m -86- n -85- xs -84- ys)
    main :89: Vec -91- 1 -90- N = append -97- N -96- Z -95- 1 -94- (Nil -99- N) -93- (Cons -103- N -102- Z -101- 4 -100- (Nil -108- N))
  in main

### Constraints ###

[] -> [2,3,7,11,33,37,40,49,52,53,61,62,65,68,69,74,75,78,79,84,85,93,94,100,101,104,105,106,107,R]
[8] -> [1,57,99,108]
[9] -> [14,38]
[10] -> [15,39]
[12] -> [1,58,77,81,103]
[13] -> [19,20,21,22,23,24,25,26,27,28,29,30,31,32,76,80,102]
[13,20] -> [59,83]
[13,21] -> [60,82]
[13,82] -> [21]
[13,83] -> [20]
[14] -> [9,43,63]
[15] -> [10,44,64]
[16] -> [38,41,43]
[17] -> [39,42,44]
[18] -> [30,73,98]
[30] -> [18]
[31] -> [82]
[32] -> [83]
[34] -> [1,56,58,72,88,97]
[35] -> [55,59,71,87,96]
[36] -> [54,60,70,86,95,98]
[38] -> [9,16,63]
[39] -> [10,17,64]
[41] -> [16,50,66]
[42] -> [17,51,67]
[43] -> [14,16,50,90]
[44] -> [15,17,51,91]
[45] -> [82]
[46] -> [83]
[47] -> [56]
[48] -> [54]
[50] -> [41,43]
[51] -> [42,44]
[54] -> [36,48]
[55] -> [35]
[56] -> [34,47]
[57] -> [8]
[58] -> [72]
[59] -> [73]
[60] -> [70]
[63] -> [14,38]
[64] -> [15,39]
[66] -> [41]
[67] -> [42]
[70] -> [36,60]
[71] -> [35,73]
[72] -> [34,58]
[73] -> [18,59,71]
[76] -> [13]
[77] -> [12]
[80] -> [13]
[81] -> [12]
[82] -> [31,45]
[83] -> [32,46]
[86] -> [36]
[87] -> [35]
[88] -> [34]
[90] -> [43]
[91] -> [44]
[92] -> [98]
[95] -> [36]
[96] -> [35]
[97] -> [34]
[98] -> [18,92]
[99] -> [8]
[102] -> [13]
[103] -> [12]
[108] -> [8]
[R] -> [89]

### Solution ###

[2,3,7,11,33,37,40,49,52,53,61,62,65,68,69,74,75,78,79,84,85,89,93,94,100,101,104,105,106,107,R]

### Annotated ###

  let
    postulate N :E: Type
    postulate Z :R: N
    postulate S :R: (x :R: N) -> N
    postulate Vec :E: (_x0 :E: N) -> (_x1 :E: Type) -> Type
    postulate Nil :R: (a :E: Type) -> Vec -E- Z -E- a
    postulate Cons :R: (a :E: Type) -> (n :E: N) -> (x :R: a) -> (xs :R: Vec -E- n -E- a) -> Vec -E- (S -E- n) -E- a
    plus :E: (_x2 :E: N) -> (_x3 :E: N) -> N 
      n :E: N
        [plus] -E- Z -E- n = n
      m :E: N n :E: N
        [plus] -E- (S -E- m) -E- n = S -E- (plus -E- m -E- n)
    append :R: (a :E: Type) -> (m :E: N) -> (n :E: N) -> (xs :R: Vec -E- m -E- a) -> (ys :R: Vec -E- n -E- a) -> Vec -E- (plus -E- m -E- n) -E- a 
      a :E: Type n :E: N ys :R: Vec -E- n -E- a
        [append] -E- a -E- [Z] -E- n -R- (Nil -E- [a]) -R- ys = ys
      a :E: Type m :E: N n :E: N x :R: a xs :R: Vec -E- m -E- a ys :R: Vec -E- n -E- a
        [append] -E- a -E- ([S] -E- m) -E- n -R- (Cons -E- [a] -E- [m] -R- x -R- xs) -R- ys = Cons -E- a -E- (plus -E- m -E- n) -R- x -R- (append -E- a -E- m -E- n -R- xs -R- ys)
    main :R: Vec -E- 1 -E- N = append -E- N -E- Z -E- 1 -R- (Nil -E- N) -R- (Cons -E- N -E- Z -R- 4 -R- (Nil -E- N))
  in main

### Specialised ###

  let
    postulate N :E: Type
    postulate Z :R: N
    postulate S :R: (x :R: N) -> N
    postulate Vec :E: (_x0 :E: N) -> (_x1 :E: Type) -> Type
    postulate Nil :R: (a :E: Type) -> Vec -E- Z -E- a
    postulate Cons :R: (a :E: Type) -> (n :E: N) -> (x :R: a) -> (xs :R: Vec -E- n -E- a) -> Vec -E- (S -E- n) -E- a
    plus :E: (_x2 :E: N) -> (_x3 :E: N) -> N 
      n :E: N
        [plus] -E- Z -E- n = n
      m :E: N n :E: N
        [plus] -E- (S -E- m) -E- n = S -E- (plus -E- m -E- n)
    append :R: (a :E: Type) -> (m :E: N) -> (n :E: N) -> (xs :R: Vec -E- m -E- a) -> (ys :R: Vec -E- n -E- a) -> Vec -E- (plus -E- m -E- n) -E- a 
      a :E: Type n :E: N ys :R: Vec -E- n -E- a
        [append] -E- a -E- [Z] -E- n -R- (Nil -E- [a]) -R- ys = ys
      a :E: Type m :E: N n :E: N x :R: a xs :R: Vec -E- m -E- a ys :R: Vec -E- n -E- a
        [append] -E- a -E- ([S] -E- m) -E- n -R- (Cons -E- [a] -E- [m] -R- x -R- xs) -R- ys = Cons -E- a -E- (plus -E- m -E- n) -R- x -R- (append -E- a -E- m -E- n -R- xs -R- ys)
    main :R: Vec -E- 1 -E- N = append -E- N -E- Z -E- 1 -R- (Nil -E- N) -R- (Cons -E- N -E- Z -R- 4 -R- (Nil -E- N))
  in main

### Final annotation ###

  let
    postulate N :E: Type
    postulate Z :R: N
    postulate S :R: (x :R: N) -> N
    postulate Vec :E: (_x0 :E: N) -> (_x1 :E: Type) -> Type
    postulate Nil :R: (a :E: Type) -> Vec -E- Z -E- a
    postulate Cons :R: (a :E: Type) -> (n :E: N) -> (x :R: a) -> (xs :R: Vec -E- n -E- a) -> Vec -E- (S -E- n) -E- a
    plus :E: (_x2 :E: N) -> (_x3 :E: N) -> N 
      n :E: N
        [plus] -E- Z -E- n = n
      m :E: N n :E: N
        [plus] -E- (S -E- m) -E- n = S -E- (plus -E- m -E- n)
    append :R: (a :E: Type) -> (m :E: N) -> (n :E: N) -> (xs :R: Vec -E- m -E- a) -> (ys :R: Vec -E- n -E- a) -> Vec -E- (plus -E- m -E- n) -E- a 
      a :E: Type n :E: N ys :R: Vec -E- n -E- a
        [append] -E- a -E- [Z] -E- n -R- (Nil -E- [a]) -R- ys = ys
      a :E: Type m :E: N n :E: N x :R: a xs :R: Vec -E- m -E- a ys :R: Vec -E- n -E- a
        [append] -E- a -E- ([S] -E- m) -E- n -R- (Cons -E- [a] -E- [m] -R- x -R- xs) -R- ys = Cons -E- a -E- (plus -E- m -E- n) -R- x -R- (append -E- a -E- m -E- n -R- xs -R- ys)
    main :R: Vec -E- 1 -E- N = append -E- N -E- Z -E- 1 -R- (Nil -E- N) -R- (Cons -E- N -E- Z -R- 4 -R- (Nil -E- N))
  in main

### Verification ###

Verification successful.

### Pruned ###

  let
    postulate Z : N
    postulate S : (x) -> N
    postulate Nil : Vec
    postulate Cons : (x) -> (xs) -> Vec
    append 
      [_] Nil ys = ys
      [_] (Cons x xs) ys = Cons x (append xs ys)
    main = append Nil (Cons 4 Nil)
  in main

### Normal forms ###

unerased:
  
  let
    postulate N : Type
    postulate Z : N
    postulate S : (x :R: N) -> N
    postulate Nil : (a : Type) -> Vec Z a
    postulate Cons : (a : Type) -> (n : N) -> (x :R: a) -> (xs :R: Vec n a) -> Vec (S n) a
  in Cons N Z 4 (Nil N)

erased:
  
  let
    postulate Z : N
    postulate S : (x) -> N
    postulate Nil : Vec
    postulate Cons : (x) -> (xs) -> Vec
  in Cons 4 Nil

