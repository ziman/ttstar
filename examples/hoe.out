-- vim: ft=agda

### Desugared ###

T : *

A : T

B : T

Op : (x  -R-  T) -> (y  -R-  T) -> T

id : (_ : T) -> T
id = \t : T. t

const_A : (_ : T) -> T
const_A = \_ : T. A

f : (g : (_ : T) -> T) -> (z : T) -> (h : (_ : T) -> T) -> (w : T) -> T
f = \g : (_ : T) -> T. \z : T. \h : (_ : T) -> T. \w : T. (Op (g z) (h w))

main  -R-  T
main = (f id B const_A B)

### Metaified ###

T :?1: *

A :?2: T

B :?3: T

Op :?4: (x :!R: T) -> (y :!R: T) -> T

id :?5: (_ :?6: T) -> T
id = \t :?7: T. t

const_A :?8: (_ :?9: T) -> T
const_A = \_ :?10: T. A

f :?11: (g :?12: (_ :?13: T) -> T) -> (z :?14: T) -> (h :?15: (_ :?16: T) -> T) -> (w :?17: T) -> T
f = \g :?18: (_ :?19: T) -> T. \z :?20: T. \h :?21: (_ :?22: T) -> T. \w :?23: T. (Op -?27- (g -?29- z) -?25- (h -?31- w))

main :!R: T
main = (f -?39- id -?37- B -?35- const_A -?33- B)

### Inferred definitions ###

A :?2: T
B :?3: T
Op :?4: (x :!R: T) -> (y :!R: T) -> T
T :?1: *
const_A :?8: (_ :?9: T) -> T
  [] -> [?2,!R]
  [?9] -> [?10]
  [?10] -> [?9]

f :?11: (g :?12: (_ :?13: T) -> T) -> (z :?14: T) -> (h :?15: (_ :?16: T) -> T) -> (w :?17: T) -> T
  [] -> [?4,?12,?15,?18,?21,?24,?25,?26,?27,!R]
  [?13] -> [?19]
  [?14] -> [?20]
  [?16] -> [?22]
  [?17] -> [?23]
  [?19] -> [?13,?20,?28,?29]
  [?20] -> [?14]
  [?22] -> [?16,?23,?30,?31]
  [?23] -> [?17]

id :?5: (_ :?6: T) -> T
  [] -> [?6,?7,!R]

main :!R: T
  [] -> [?2_3,?3,?4_1,?5,?6,?6_2,?7_2,?8,?11,?12,?12_1,?13,?13_1,?14,?14_1,?15,?15_1,?18_1,?19_1,?20_1,?21_1,?24_1,?25_1,?26_1,?27_1,?28_1,?29_1,?34,?35,?36,?37,?38,?39,!R]
  [?9_3] -> [?9,?10_3,?16_1]
  [?10_3] -> [?9_3]
  [?16_1] -> [?9_3,?16,?22_1]
  [?17] -> [?32]
  [?17_1] -> [?17,?23_1,?33]
  [?22_1] -> [?16_1,?23_1,?30_1,?31_1]
  [?23_1] -> [?17_1]


### Constraints ###

[] -> [?2,?2_3,?3,?4,?4_1,?5,?6,?6_2,?7,?7_2,?8,?11,?12,?12_1,?13,?13_1,?14,?14_1,?15,?15_1,?18,?18_1,?19_1,?20_1,?21,?21_1,?24,?24_1,?25,?25_1,?26,?26_1,?27,?27_1,?28_1,?29_1,?34,?35,?36,?37,?38,?39,!R]
[?9] -> [?10]
[?9_3] -> [?9,?10_3,?16_1]
[?10] -> [?9]
[?10_3] -> [?9_3]
[?13] -> [?19]
[?14] -> [?20]
[?16] -> [?22]
[?16_1] -> [?9_3,?16,?22_1]
[?17] -> [?23,?32]
[?17_1] -> [?17,?23_1,?33]
[?19] -> [?13,?20,?28,?29]
[?20] -> [?14]
[?22] -> [?16,?23,?30,?31]
[?22_1] -> [?16_1,?23_1,?30_1,?31_1]
[?23] -> [?17]
[?23_1] -> [?17_1]

### Solution ###

[?2,?2_3,?3,?4,?4_1,?5,?6,?6_2,?7,?7_2,?8,?11,?12,?12_1,?13,?13_1,?14,?14_1,?15,?15_1,?18,?18_1,?19,?19_1,?20,?20_1,?21,?21_1,?24,?24_1,?25,?25_1,?26,?26_1,?27,?27_1,?28,?28_1,?29,?29_1,?34,?35,?36,?37,?38,?39,!R]

### Annotated ###

T :E: *

A :R: T

B :R: T

Op :R: (x :R: T) -> (y :R: T) -> T

id :R: (_ :R: T) -> T
id = \t :R: T. t

const_A :R: (_ :E: T) -> T
const_A = \_ :E: T. A

f :R: (g :R: (_ :R: T) -> T) -> (z :R: T) -> (h :R: (_ :E: T) -> T) -> (w :E: T) -> T
f = \g :R: (_ :R: T) -> T. \z :R: T. \h :R: (_ :E: T) -> T. \w :E: T. (Op -R- (g -R- z) -R- (h -E- w))

main :R: T
main = (f -R- id -R- B -R- const_A -E- B)

### Pruned ###

id = \t. t

const_A = A

f = \g. \z. \h. (Op (g z) h)

main = (f id B const_A)

### Reductions ###

unerased:
  (Op B A)
erased:
  (Op B A)
