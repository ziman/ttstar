-- vim: ft=agda

### Desugared ###

postulate T : Type

postulate A : T

postulate B : T

postulate Op : (x :ᴿ T) -> (y :ᴿ T) -> T

id : (x : T) -> T = (\x : T. x)

const_A : (x : T) -> T = (\x : T. A)

f : (g : (_ : T) -> T) -> (z : T) -> (h : (_ : T) -> T) -> (w : T) -> T = (\g : (_ : T) -> T. (\z : T. (\h : (_ : T) -> T. (\w : T. Op (g z) (h w)))))

main :ᴿ T = f id B const_A B

### Metaified ###

postulate T :¹ Type

postulate A :² T

postulate B :³ T

postulate Op :⁴ (x :ᴿ T) -> (y :ᴿ T) -> T

id :⁵ (x :⁶ T) -> T = (\x :⁷ T. x)

const_A :⁸ (x :⁹ T) -> T = (\x :¹⁰ T. A)

f :¹¹ (g :¹² (_ :¹³ T) -> T) -> (z :¹⁴ T) -> (h :¹⁵ (_ :¹⁶ T) -> T) -> (w :¹⁷ T) -> T = (\g :¹⁸ (_ :¹⁹ T) -> T. (\z :²⁰ T. (\h :²¹ (_ :²² T) -> T. (\w :²³ T. Op ²⁵ (g ²⁶ z) ²⁴ (h ²⁷ w)))))

main :ᴿ T = f ³¹ id ³⁰ B ²⁹ const_A ²⁸ B

### Inferred definitions ###

postulate A :² T

postulate B :³ T

postulate Op :⁴ (x :ᴿ T) -> (y :ᴿ T) -> T

postulate T :¹ Type

postulate Type :ᴿ Type

const_A :⁸ (x :⁹ T) -> T = (\x :¹⁰ T. A)
  [8] -> [2]
  [8,9] -> [10]
  [8,10] -> [9]

f :¹¹ (g :¹² (_ :¹³ T) -> T) -> (z :¹⁴ T) -> (h :¹⁵ (_ :¹⁶ T) -> T) -> (w :¹⁷ T) -> T = (\g :¹⁸ (_ :¹⁹ T) -> T. (\z :²⁰ T. (\h :²¹ (_ :²² T) -> T. (\w :²³ T. Op ²⁵ (g ²⁶ z) ²⁴ (h ²⁷ w)))))
  [11] -> [4,18,21,24,25]
  [11,12] -> [18]
  [11,13] -> [19]
  [11,14] -> [20]
  [11,15] -> [21]
  [11,16] -> [22]
  [11,17] -> [23]
  [11,18] -> [12]
  [11,19] -> [13,20,26]
  [11,20] -> [14]
  [11,21] -> [15]
  [11,22] -> [16,23,27]
  [11,23] -> [17]
  [11,26] -> [19]
  [11,27] -> [22]

id :⁵ (x :⁶ T) -> T = (\x :⁷ T. x)
  [5] -> [7]
  [5,6] -> [7]
  [5,7] -> [6]

main :ᴿ T = f ³¹ id ³⁰ B ²⁹ const_A ²⁸ B
  [] -> [11,R]
  [6] -> [13]
  [9] -> [16]
  [12] -> [5,31]
  [13] -> [6]
  [14] -> [3,30]
  [15] -> [8,29]
  [16] -> [9]
  [17] -> [3,28]
  [28] -> [17]
  [29] -> [15]
  [30] -> [14]
  [31] -> [12]


### Constraints ###

[] -> [11,R]
[5] -> [7]
[5,6] -> [7]
[5,7] -> [6]
[6] -> [13]
[8] -> [2]
[8,9] -> [10]
[8,10] -> [9]
[9] -> [16]
[11] -> [4,18,21,24,25]
[11,12] -> [18]
[11,13] -> [19]
[11,14] -> [20]
[11,15] -> [21]
[11,16] -> [22]
[11,17] -> [23]
[11,18] -> [12]
[11,19] -> [13,20,26]
[11,20] -> [14]
[11,21] -> [15]
[11,22] -> [16,23,27]
[11,23] -> [17]
[11,26] -> [19]
[11,27] -> [22]
[12] -> [5,31]
[13] -> [6]
[14] -> [3,30]
[15] -> [8,29]
[16] -> [9]
[17] -> [3,28]
[28] -> [17]
[29] -> [15]
[30] -> [14]
[31] -> [12]

### Solution ###

[2,3,4,5,6,7,8,11,12,13,14,15,18,19,20,21,24,25,26,29,30,31,R]

### Annotated ###

postulate T :ᴱ Type

postulate A :ᴿ T

postulate B :ᴿ T

postulate Op :ᴿ (x :ᴿ T) -> (y :ᴿ T) -> T

id :ᴿ (x :ᴿ T) -> T = (\x :ᴿ T. x)

const_A :ᴿ (x :ᴱ T) -> T = (\x :ᴱ T. A)

f :ᴿ (g :ᴿ (_ :ᴿ T) -> T) -> (z :ᴿ T) -> (h :ᴿ (_ :ᴱ T) -> T) -> (w :ᴱ T) -> T = (\g :ᴿ (_ :ᴿ T) -> T. (\z :ᴿ T. (\h :ᴿ (_ :ᴱ T) -> T. (\w :ᴱ T. Op ᴿ (g ᴿ z) ᴿ (h ᴱ w)))))

main :ᴿ T = f ᴿ id ᴿ B ᴿ const_A ᴱ B

### Specialised ###

postulate T :ᴱ Type

postulate A :ᴿ T

postulate B :ᴿ T

postulate Op :ᴿ (x :ᴿ T) -> (y :ᴿ T) -> T

id :ᴿ (x :ᴿ T) -> T = (\x :ᴿ T. x)

const_A :ᴿ (x :ᴱ T) -> T = (\x :ᴱ T. A)

f :ᴿ (g :ᴿ (_ :ᴿ T) -> T) -> (z :ᴿ T) -> (h :ᴿ (_ :ᴱ T) -> T) -> (w :ᴱ T) -> T = (\g :ᴿ (_ :ᴿ T) -> T. (\z :ᴿ T. (\h :ᴿ (_ :ᴱ T) -> T. (\w :ᴱ T. Op ᴿ (g ᴿ z) ᴿ (h ᴱ w)))))

main :ᴿ T = f ᴿ id ᴿ B ᴿ const_A ᴱ B

### Final annotation ###

postulate T :ᴱ Type

postulate A :ᴿ T

postulate B :ᴿ T

postulate Op :ᴿ (x :ᴿ T) -> (y :ᴿ T) -> T

id :ᴿ (x :ᴿ T) -> T = (\x :ᴿ T. x)

const_A :ᴿ (x :ᴱ T) -> T = (\x :ᴱ T. A)

f :ᴿ (g :ᴿ (_ :ᴿ T) -> T) -> (z :ᴿ T) -> (h :ᴿ (_ :ᴱ T) -> T) -> (w :ᴱ T) -> T = (\g :ᴿ (_ :ᴿ T) -> T. (\z :ᴿ T. (\h :ᴿ (_ :ᴱ T) -> T. (\w :ᴱ T. Op ᴿ (g ᴿ z) ᴿ (h ᴱ w)))))

main :ᴿ T = f ᴿ id ᴿ B ᴿ const_A ᴱ B

### Verification ###

Verification successful.

### Pruned ###

postulate A

postulate B

postulate Op

id = (\x. x)

const_A = A

f = (\g. (\z. (\h. Op (g z) h)))

main = f id B const_A

### Normal forms ###

unerased:
  Op B A
erased:
  Op B A
