-- vim: ft=agda

### Desugared ###

T : *

A : T

B : T

Op : (x  -R-  T) -> (y  -R-  T) -> T

id : (_ : T) -> T
id = (\t : T. t)

const_A : (_ : T) -> T
const_A = (\_ : T. A)

f : (g : (_ : T) -> T) -> (z : T) -> (h : (_ : T) -> T) -> (w : T) -> T
f = (\g : (_ : T) -> T. (\z : T. (\h : (_ : T) -> T. (\w : T. (Op (g z) (h w))))))

main  -R-  T
main = (f id B const_A B)

### Metaified ###

T :?1: *

A :?2: T

B :?3: T

Op :?4: (x :!R: T) -> (y :!R: T) -> T

id :?5: (_ :?6: T) -> T
id = (\t :?7: T. t)

const_A :?8: (_ :?9: T) -> T
const_A = (\_ :?10: T. A)

f :?11: (g :?12: (_ :?13: T) -> T) -> (z :?14: T) -> (h :?15: (_ :?16: T) -> T) -> (w :?17: T) -> T
f = (\g :?18: (_ :?19: T) -> T. (\z :?20: T. (\h :?21: (_ :?22: T) -> T. (\w :?23: T. (Op -?25- (g -?26- z) -?24- (h -?27- w))))))

main :!R: T
main = (f -?31- id -?30- B -?29- const_A -?28- B)

### Final annotation ###

### Inferred definitions ###

A :?2: T
B :?3: T
Op :?4: (x :!R: T) -> (y :!R: T) -> T
T :?1: *
const_A :?8: (_ :?9: T) -> T
  [] -> [?2,!R]
  [?9] -> [?10]
  [?10] -> [?9]

f :?11: (g :?12: (_ :?13: T) -> T) -> (z :?14: T) -> (h :?15: (_ :?16: T) -> T) -> (w :?17: T) -> T
  [] -> [?4,?12,?15,?18,?21,?24,?25,!R]
  [?13] -> [?19]
  [?14] -> [?20]
  [?16] -> [?22]
  [?17] -> [?23]
  [?19] -> [?13,?20,?26]
  [?20] -> [?14]
  [?22] -> [?16,?23,?27]
  [?23] -> [?17]
  [?26] -> [?19]
  [?27] -> [?22]

id :?5: (_ :?6: T) -> T
  [] -> [?6,?7,!R]

main :!R: T
  [] -> [?11,!R]
  [?6] -> [?13]
  [?9] -> [?16]
  [?12] -> [?5,?31]
  [?13] -> [?6]
  [?14] -> [?3,?30]
  [?15] -> [?8,?29]
  [?16] -> [?9]
  [?17] -> [?3,?28]
  [?28] -> [?17]
  [?29] -> [?15]
  [?30] -> [?14]
  [?31] -> [?12]


### Constraints ###

[] -> [?2,?4,?6,?7,?11,?12,?15,?18,?21,?24,?25,!R]
[?6] -> [?13]
[?9] -> [?10,?16]
[?10] -> [?9]
[?12] -> [?5,?31]
[?13] -> [?6,?19]
[?14] -> [?3,?20,?30]
[?15] -> [?8,?29]
[?16] -> [?9,?22]
[?17] -> [?3,?23,?28]
[?19] -> [?13,?20,?26]
[?20] -> [?14]
[?22] -> [?16,?23,?27]
[?23] -> [?17]
[?26] -> [?19]
[?27] -> [?22]
[?28] -> [?17]
[?29] -> [?15]
[?30] -> [?14]
[?31] -> [?12]

### Solution ###

[?2,?3,?4,?5,?6,?7,?8,?11,?12,?13,?14,?15,?18,?19,?20,?21,?24,?25,?26,?29,?30,?31,!R]

### Annotated ###

T :E: *

A :R: T

B :R: T

Op :R: (x :R: T) -> (y :R: T) -> T

id :R: (_ :R: T) -> T
id = (\t :R: T. t)

const_A :R: (_ :E: T) -> T
const_A = (\_ :E: T. A)

f :R: (g :R: (_ :R: T) -> T) -> (z :R: T) -> (h :R: (_ :E: T) -> T) -> (w :E: T) -> T
f = (\g :R: (_ :R: T) -> T. (\z :R: T. (\h :R: (_ :E: T) -> T. (\w :E: T. (Op -R- (g -R- z) -R- (h -E- w))))))

main :R: T
main = (f -R- id -R- B -R- const_A -E- B)

### Specialised ###

T :!E: *

A :!R: T

B :!R: T

Op :!R: (x :!R: T) -> (y :!R: T) -> T

id :!R: (_ :!R: T) -> T
id = (\t :!R: T. t)

const_A :!R: (_ :!E: T) -> T
const_A = (\_ :!E: T. A)

f :!R: (g :!R: (_ :!R: T) -> T) -> (z :!R: T) -> (h :!R: (_ :!E: T) -> T) -> (w :!E: T) -> T
f = (\g :!R: (_ :!R: T) -> T. (\z :!R: T. (\h :!R: (_ :!E: T) -> T. (\w :!E: T. (Op -!R- (g -!R- z) -!R- (h -!E- w))))))

main :!R: T
main = (f -!R- id -!R- B -!R- const_A -!E- B)

T :E: *

A :R: T

B :R: T

Op :R: (x :R: T) -> (y :R: T) -> T

id :R: (_ :R: T) -> T
id = (\t :R: T. t)

const_A :R: (_ :E: T) -> T
const_A = (\_ :E: T. A)

f :R: (g :R: (_ :R: T) -> T) -> (z :R: T) -> (h :R: (_ :E: T) -> T) -> (w :E: T) -> T
f = (\g :R: (_ :R: T) -> T. (\z :R: T. (\h :R: (_ :E: T) -> T. (\w :E: T. (Op -R- (g -R- z) -R- (h -E- w))))))

main :R: T
main = (f -R- id -R- B -R- const_A -E- B)

### Pruned ###

id = (\t. t)

const_A = A

f = (\g. (\z. (\h. (Op (g z) h))))

main = (f id B const_A)

### Normal forms ###

unerased:
  (Op B A)
erased:
  (Op B A)
