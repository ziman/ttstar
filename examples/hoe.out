-- vim: ft=agda

### Desugared ###

T : *
T = (axiom)

A : T
A = (axiom)

B : T
B = (axiom)

Op : (x  -R-  T) -> (y  -R-  T) -> T
Op = (axiom)

id : (_ : T) -> T
id = \t : T. t

const_A : (_ : T) -> T
const_A = \_ : T. A

f : (g : (_ : T) -> T) -> (z : T) -> (h : (_ : T) -> T) -> (w : T) -> T
f = \g : (_ : T) -> T. \z : T. \h : (_ : T) -> T. \w : T. (Op (g z) (h w))

main  -R-  T
main = (f id B const_A B)

### Metaified ###

T :?1: *
T = (axiom)

A :?2: T
A = (axiom)

B :?3: T
B = (axiom)

Op :?4: (x :!R: T) -> (y :!R: T) -> T
Op = (axiom)

id :?5: (_ :?6: T) -> T
id = \t :?7: T. t

const_A :?8: (_ :?9: T) -> T
const_A = \_ :?10: T. A

f :?11: (g :?12: (_ :?13: T) -> T) -> (z :?14: T) -> (h :?15: (_ :?16: T) -> T) -> (w :?17: T) -> T
f = \g :?18: (_ :?19: T) -> T. \z :?20: T. \h :?21: (_ :?22: T) -> T. \w :?23: T. (Op -?25- (g -?26- z) -?24- (h -?27- w))

main :!R: T
main = (f -?31- id -?30- B -?29- const_A -?28- B)

### Constraints ###

[?2] <- [!R]
[?3] <- [?28,!R]
[?3] <- [?30,!R]
[?4] <- [!R]
[?5] <- [?31,!R]
[?6] <- [?7]
[?6] <- [?13]
[?7] <- [?6]
[?7] <- [!R]
[?8] <- [?29,!R]
[?9] <- [?10]
[?9] <- [?16]
[?10] <- [?9]
[?11] <- [!R]
[?12] <- [?18]
[?12] <- [?31]
[?13] <- [?6]
[?13] <- [?19]
[?14] <- [?20]
[?14] <- [?30]
[?15] <- [?21]
[?15] <- [?29]
[?16] <- [?9]
[?16] <- [?22]
[?17] <- [?23]
[?17] <- [?28]
[?18] <- [?12]
[?18] <- [?25,!R]
[?19] <- [?13]
[?19] <- [?25,?26]
[?20] <- [?14]
[?20] <- [?25,?26,!R]
[?21] <- [?15]
[?21] <- [?24,!R]
[?22] <- [?16]
[?22] <- [?24,?27]
[?23] <- [?17]
[?23] <- [?24,?27,!R]
[?24] <- [!R]
[?25] <- [!R]
[?26] <- [?19,?25]
[?27] <- [?22,?24]
[?28] <- [?17]
[?29] <- [?15]
[?30] <- [?14]
[?31] <- [?12]
[!R] <- [?24]
[!R] <- [?25]

### Solution ###

[?2,?3,?4,?5,?6,?7,?8,?11,?12,?13,?14,?15,?18,?19,?20,?21,?24,?25,?26,?29,?30,?31,!R]

### Annotated ###

T :I: *
T = (axiom)

A :R: T
A = (axiom)

B :R: T
B = (axiom)

Op :R: (x :R: T) -> (y :R: T) -> T
Op = (axiom)

id :R: (_ :R: T) -> T
id = \t :R: T. t

const_A :R: (_ :I: T) -> T
const_A = \_ :I: T. A

f :R: (g :R: (_ :R: T) -> T) -> (z :R: T) -> (h :R: (_ :I: T) -> T) -> (w :I: T) -> T
f = \g :R: (_ :R: T) -> T. \z :R: T. \h :R: (_ :I: T) -> T. \w :I: T. (Op -R- (g -R- z) -R- (h -I- w))

main :R: T
main = (f -R- id -R- B -R- const_A -I- B)

### Pruned ###

A = (axiom)

B = (axiom)

Op = (axiom)

id = \t. t

const_A = A

f = \g. \z. \h. (Op (g z) h)

main = (f id B const_A)

