-- vim: ft=agda

### Desugared ###

T : *

A : T

B : T

Op : (x : -R-  T) -> (y : -R-  T) -> T

id : (_ :: T) -> T
id = \t :: T. t

const_A : (_ :: T) -> T
const_A = \_ :: T. A

f : (g :: (_ :: T) -> T) -> (z :: T) -> (h :: (_ :: T) -> T) -> (w :: T) -> T
f = \g :: (_ :: T) -> T. \z :: T. \h :: (_ :: T) -> T. \w :: T. (Op  (g  z)  (h  w))

main  -R-  T
main = (f  id  B  const_A  B)

### Metaified ###

T :?1: *

A :?2: T

B :?3: T

Op :?4: (x :?5::!R: T) -> (y :?6::!R: T) -> T

id :?7: (_ :?9::?8: T) -> T
id = \t :?11::?10: T. t

const_A :?12: (_ :?14::?13: T) -> T
const_A = \_ :?16::?15: T. A

f :?17: (g :?21::?18: (_ :?20::?19: T) -> T) -> (z :?23::?22: T) -> (h :?27::?24: (_ :?26::?25: T) -> T) -> (w :?29::?28: T) -> T
f = \g :?33::?30: (_ :?32::?31: T) -> T. \z :?35::?34: T. \h :?39::?36: (_ :?38::?37: T) -> T. \w :?41::?40: T. (Op -?44-  -?45- (g -?46-  -?47- z) -?42-  -?43- (h -?48-  -?49- w))

main :!R: T
main = (f -?56-  -?57- id -?54-  -?55- B -?52-  -?53- const_A -?50-  -?51- B)

### Inferred definitions ###

A :?2: T
B :?3: T
Op :?4: (x :?5::!R: T) -> (y :?6::!R: T) -> T
T :?1: *
const_A :?12: (_ :?14::?13: T) -> T
  [] -> [?2,!R]
  [?13] -> [?15]
  [?14] -> [?16]
  [?15] -> [?13]
  [?16] -> [?14]

f :?17: (g :?21::?18: (_ :?20::?19: T) -> T) -> (z :?23::?22: T) -> (h :?27::?24: (_ :?26::?25: T) -> T) -> (w :?29::?28: T) -> T
  [] -> [?4,?18,?24,?30,?36,?43,?45,!R]
  [?5] -> [?44]
  [?6] -> [?42]
  [?19] -> [?31]
  [?20] -> [?32]
  [?21] -> [?33]
  [?22] -> [?34]
  [?23] -> [?35]
  [?25] -> [?37]
  [?26] -> [?38]
  [?27] -> [?39]
  [?28] -> [?40]
  [?29] -> [?41]
  [?31] -> [?19,?34,?47]
  [?32] -> [?20,?46]
  [?33] -> [?21]
  [?34] -> [?22]
  [?35] -> [?23]
  [?37] -> [?25,?40,?49]
  [?38] -> [?26,?48]
  [?39] -> [?27]
  [?40] -> [?28]
  [?41] -> [?29]
  [?42] -> [?6]
  [?44] -> [?5]
  [?46] -> [?32]
  [?47] -> [?31]
  [?48] -> [?38]
  [?49] -> [?37]

id :?7: (_ :?9::?8: T) -> T
  [] -> [?8,?10,!R]
  [?9] -> [?11]
  [?11] -> [?9]

