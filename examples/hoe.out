-- vim: ft=agda

### Desugared ###

T : *
T = (axiom)

A : T
A = (axiom)

B : T
B = (axiom)

Op : (x  -R-  T) -> (y  -R-  T) -> T
Op = (axiom)

id : (_ : T) -> T
id = \t : T. t

const_A : (_ : T) -> T
const_A = \_ : T. A

f : (g : (_ : T) -> T) -> (z : T) -> (h : (_ : T) -> T) -> (w : T) -> T
f = \g : (_ : T) -> T. \z : T. \h : (_ : T) -> T. \w : T. (Op (g z) (h w))

main  -R-  T
main = (f id B const_A B)

### Metaified ###

T :?1: *
T = (axiom)

A :?2: T
A = (axiom)

B :?3: T
B = (axiom)

Op :?4: (x :!R: T) -> (y :!R: T) -> T
Op = (axiom)

id :?5: (_ :?6: T) -> T
id = \t :?7: T. t

const_A :?8: (_ :?9: T) -> T
const_A = \_ :?10: T. A

f :?11: (g :?12: (_ :?13: T) -> T) -> (z :?14: T) -> (h :?15: (_ :?16: T) -> T) -> (w :?17: T) -> T
f = \g :?18: (_ :?19: T) -> T. \z :?20: T. \h :?21: (_ :?22: T) -> T. \w :?23: T. (Op -?27- (g -?29- z) -?25- (h -?31- w))

main :!R: T
main = (f -?39- id -?37- B -?35- const_A -?33- B)

### Inferred definitions ###

A :?2: T

B :?3: T

Op :?4: (x :!R: T) -> (y :!R: T) -> T

T :?1: *

const_A :?8: (_ :?9: T) -> T
  [] -> [?2,!R]
  [?9] -> [?10]
  [?10] -> [?9]

f :?11: (g :?12: (_ :?13: T) -> T) -> (z :?14: T) -> (h :?15: (_ :?16: T) -> T) -> (w :?17: T) -> T
  [] -> [?4,?12,?15,?18,?21,?24,?25,?26,?27,!R]
  [?13] -> [?19]
  [?14] -> [?20]
  [?16] -> [?22]
  [?17] -> [?23]
  [?19] -> [?13,?28]
  [?19_4] -> [?19,?20,?29]
  [?20] -> [?14]
  [?22] -> [?16,?30]
  [?22_6] -> [?22,?23,?31]
  [?23] -> [?17]

id :?5: (_ :?6: T) -> T
  [] -> [?6,?7,!R]

main :!R: T
  [] -> [?2_11,?3,?4_8,?5,?6,?6_9,?7_9,?8,?11,?12,?12_8,?13,?13_8,?14,?14_8,?15,?15_8,?18_8,?19_8,?20_8,?21_8,?24_8,?25_8,?26_8,?27_8,?28_8,?29_8,?34,?35,?36,?37,?38,?39,!R]
  [?9_11] -> [?9,?10_11,?16_8]
  [?10_11] -> [?9_11]
  [?16_8] -> [?9_11,?16,?22_8]
  [?17] -> [?32]
  [?17_8] -> [?17,?23_8,?33]
  [?22_8] -> [?16_8,?22_8,?23_8,?30_8,?31_8]
  [?23_8] -> [?17_8]


### Constraints ###

[] -> [?2,?2_11,?3,?4,?4_8,?5,?6,?6_9,?7,?7_9,?8,?11,?12,?12_8,?13,?13_8,?14,?14_8,?15,?15_8,?18,?18_8,?19_8,?20_8,?21,?21_8,?24,?24_8,?25,?25_8,?26,?26_8,?27,?27_8,?28_8,?29_8,?34,?35,?36,?37,?38,?39,!R]
[?9] -> [?10]
[?9_11] -> [?9,?10_11,?16_8]
[?10] -> [?9]
[?10_11] -> [?9_11]
[?13] -> [?19]
[?14] -> [?20]
[?16] -> [?22]
[?16_8] -> [?9_11,?16,?22_8]
[?17] -> [?23,?32]
[?17_8] -> [?17,?23_8,?33]
[?19] -> [?13,?28]
[?19_4] -> [?19,?20,?29]
[?20] -> [?14]
[?22] -> [?16,?30]
[?22_6] -> [?22,?23,?31]
[?22_8] -> [?16_8,?22_8,?23_8,?30_8,?31_8]
[?23] -> [?17]
[?23_8] -> [?17_8]

### Solution ###

[?2,?2_11,?3,?4,?4_8,?5,?6,?6_9,?7,?7_9,?8,?11,?12,?12_8,?13,?13_8,?14,?14_8,?15,?15_8,?18,?18_8,?19,?19_8,?20,?20_8,?21,?21_8,?24,?24_8,?25,?25_8,?26,?26_8,?27,?27_8,?28,?28_8,?29_8,?34,?35,?36,?37,?38,?39,!R]

### Annotated ###

T :I: *
T = (axiom)

A :R: T
A = (axiom)

B :R: T
B = (axiom)

Op :R: (x :R: T) -> (y :R: T) -> T
Op = (axiom)

id :R: (_ :R: T) -> T
id = \t :R: T. t

const_A :R: (_ :I: T) -> T
const_A = \_ :I: T. A

f :R: (g :R: (_ :R: T) -> T) -> (z :R: T) -> (h :R: (_ :I: T) -> T) -> (w :I: T) -> T
f = \g :R: (_ :R: T) -> T. \z :R: T. \h :R: (_ :I: T) -> T. \w :I: T. (Op -R- (g -I- z) -R- (h -I- w))

main :R: T
main = (f -R- id -R- B -R- const_A -I- B)

### Pruned ###

A = (axiom)

B = (axiom)

Op = (axiom)

id = \t. t

const_A = A

f = \g. \z. \h. (Op (g ____) h)

main = (f id B const_A)

