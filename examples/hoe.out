-- vim: ft=agda

### Desugared ###

T : *

A : T

B : T

Op : (x  -R- : T) -> (y  -R- : T) -> T

id : (_ :: T) -> T
id = \t :: T. t

const_A : (_ :: T) -> T
const_A = \_ :: T. A

f : (g :: (_ :: T) -> T) -> (z :: T) -> (h :: (_ :: T) -> T) -> (w :: T) -> T
f = \g :: (_ :: T) -> T. \z :: T. \h :: (_ :: T) -> T. \w :: T. (Op (g z) (h w))

main  -R-  T
main = (f id B const_A B)

### Metaified ###

T :?1: *

A :?2: T

B :?3: T

Op :?4: (x :!R::?5: T) -> (y :!R::?6: T) -> T

id :?7: (_ :?8::?9: T) -> T
id = \t :?10::?11: T. t

const_A :?12: (_ :?13::?14: T) -> T
const_A = \_ :?15::?16: T. A

f :?17: (g :?18::?21: (_ :?19::?20: T) -> T) -> (z :?22::?23: T) -> (h :?24::?27: (_ :?25::?26: T) -> T) -> (w :?28::?29: T) -> T
f = \g :?30::?33: (_ :?31::?32: T) -> T. \z :?34::?35: T. \h :?36::?39: (_ :?37::?38: T) -> T. \w :?40::?41: T. (Op -?45- (g -?47- z) -?43- (h -?49- w))

main :!R: T
main = (f -?57- id -?55- B -?53- const_A -?51- B)

### Inferred definitions ###

A :?2: T
B :?3: T
Op :?4: (x :!R::?5: T) -> (y :!R::?6: T) -> T
T :?1: *
const_A :?12: (_ :?13::?14: T) -> T
  [] -> [?2,!R]
  [?13] -> [?15]
  [?14] -> [?16]
  [?15] -> [?13]
  [?16] -> [?14]

f :?17: (g :?18::?21: (_ :?19::?20: T) -> T) -> (z :?22::?23: T) -> (h :?24::?27: (_ :?25::?26: T) -> T) -> (w :?28::?29: T) -> T
  [] -> [?4,?5,?6,?18,?24,?30,?36,?42,?43,?44,?45,!R]
  [?19] -> [?31]
  [?20] -> [?32]
  [?21] -> [?33]
  [?22] -> [?34]
  [?23] -> [?35]
  [?25] -> [?37]
  [?26] -> [?38]
  [?27] -> [?39]
  [?28] -> [?40]
  [?29] -> [?41]
  [?31] -> [?19,?34,?46,?47]
  [?32] -> [?20]
  [?33] -> [?21]
  [?34] -> [?22]
  [?35] -> [?23]
  [?37] -> [?25,?40,?48,?49]
  [?38] -> [?26]
  [?39] -> [?27]
  [?40] -> [?28]
  [?41] -> [?29]
  [?47] -> [?32]
  [?49] -> [?38]

id :?7: (_ :?8::?9: T) -> T
  [] -> [?8,?10,!R]
  [?9] -> [?11]
  [?11] -> [?9]

main :!R: T
  [] -> [?2_3,?3,?4_1,?5_1,?6_1,?7,?8,?8_2,?9_2,?10_2,?11_2,?12,?17,?18,?18_1,?19,?19_1,?20_1,?21_1,?22,?22_1,?23_1,?24,?24_1,?27_1,?30_1,?31_1,?32_1,?33_1,?34_1,?35_1,?36_1,?39_1,?42_1,?43_1,?44_1,?45_1,?46_1,?47_1,?52,?53,?54,?55,?56,?57,!R]
  [?13_3] -> [?13,?15_3,?25_1]
  [?14_3] -> [?16_3,?26_1]
  [?15_3] -> [?13_3]
  [?16_3] -> [?14_3]
  [?25_1] -> [?13_3,?25,?37_1]
  [?26_1] -> [?14_3,?38_1]
  [?28] -> [?50]
  [?28_1] -> [?28,?40_1,?51]
  [?29_1] -> [?41_1]
  [?37_1] -> [?25_1,?40_1,?48_1,?49_1]
  [?38_1] -> [?26_1]
  [?40_1] -> [?28_1]
  [?41_1] -> [?29_1]
  [?49_1] -> [?38_1]
  [?51] -> [?29_1]


### Constraints ###

[] -> [?2,?2_3,?3,?4,?4_1,?5,?5_1,?6,?6_1,?7,?8,?8_2,?9_2,?10,?10_2,?11_2,?12,?17,?18,?18_1,?19,?19_1,?20_1,?21_1,?22,?22_1,?23_1,?24,?24_1,?27_1,?30,?30_1,?31_1,?32_1,?33_1,?34_1,?35_1,?36,?36_1,?39_1,?42,?42_1,?43,?43_1,?44,?44_1,?45,?45_1,?46_1,?47_1,?52,?53,?54,?55,?56,?57,!R]
[?9] -> [?11]
[?11] -> [?9]
[?13] -> [?15]
[?13_3] -> [?13,?15_3,?25_1]
[?14] -> [?16]
[?14_3] -> [?16_3,?26_1]
[?15] -> [?13]
[?15_3] -> [?13_3]
[?16] -> [?14]
[?16_3] -> [?14_3]
[?19] -> [?31]
[?20] -> [?32]
[?21] -> [?33]
[?22] -> [?34]
[?23] -> [?35]
[?25] -> [?37]
[?25_1] -> [?13_3,?25,?37_1]
[?26] -> [?38]
[?26_1] -> [?14_3,?38_1]
[?27] -> [?39]
[?28] -> [?40,?50]
[?28_1] -> [?28,?40_1,?51]
[?29] -> [?41]
[?29_1] -> [?41_1]
[?31] -> [?19,?34,?46,?47]
[?32] -> [?20]
[?33] -> [?21]
[?34] -> [?22]
[?35] -> [?23]
[?37] -> [?25,?40,?48,?49]
[?37_1] -> [?25_1,?40_1,?48_1,?49_1]
[?38] -> [?26]
[?38_1] -> [?26_1]
[?39] -> [?27]
[?40] -> [?28]
[?40_1] -> [?28_1]
[?41] -> [?29]
[?41_1] -> [?29_1]
[?47] -> [?32]
[?49] -> [?38]
[?49_1] -> [?38_1]
[?51] -> [?29_1]

### Solution ###

[?2,?2_3,?3,?4,?4_1,?5,?5_1,?6,?6_1,?7,?8,?8_2,?9_2,?10,?10_2,?11_2,?12,?17,?18,?18_1,?19,?19_1,?20,?20_1,?21_1,?22,?22_1,?23_1,?24,?24_1,?27_1,?30,?30_1,?31,?31_1,?32,?32_1,?33_1,?34,?34_1,?35_1,?36,?36_1,?39_1,?42,?42_1,?43,?43_1,?44,?44_1,?45,?45_1,?46,?46_1,?47,?47_1,?52,?53,?54,?55,?56,?57,!R]

### Annotated ###

T :E: *

A :R: T

B :R: T

Op :R: (x :R::R: T) -> (y :R::R: T) -> T

id :R: (_ :R::E: T) -> T
id = \t :R::E: T. t

const_A :R: (_ :E::E: T) -> T
const_A = \_ :E::E: T. A

f :R: (g :R::E: (_ :R::R: T) -> T) -> (z :R::E: T) -> (h :R::E: (_ :E::E: T) -> T) -> (w :E::E: T) -> T
f = \g :R::E: (_ :R::R: T) -> T. \z :R::E: T. \h :R::E: (_ :E::E: T) -> T. \w :E::E: T. (Op -R- (g -R- z) -R- (h -E- w))

main :R: T
main = (f -R- id -R- B -R- const_A -E- B)

### Pruned ###

id = \t. t

const_A = A

f = \g. \z. \h. (Op (g z) h)

main = (f id B const_A)

### Normal forms ###

unerased:
  (Op B A)
erased:
  (Op B A)
