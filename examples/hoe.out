-- vim: ft=agda

### Desugared ###

T : *
T = (axiom)

A : T
A = (axiom)

B : T
B = (axiom)

Op : (x  -R-  T) -> (y  -R-  T) -> T
Op = (axiom)

id : (_ : T) -> T
id = \t : T. t

const_A : (_ : T) -> T
const_A = \_ : T. A

f : (g : (_ : T) -> T) -> (z : T) -> (h : (_ : T) -> T) -> (w : T) -> T
f = \g : (_ : T) -> T. \z : T. \h : (_ : T) -> T. \w : T. (Op (g z) (h w))

main  -R-  T
main = (f id B const_A B)

### Metaified ###

T :?1: *
T = (axiom)

A :?2: T
A = (axiom)

B :?3: T
B = (axiom)

Op :?4: (x :!R: T) -> (y :!R: T) -> T
Op = (axiom)

id :?5: (_ :?6: T) -> T
id = \t :?7: T. t

const_A :?8: (_ :?9: T) -> T
const_A = \_ :?10: T. A

f :?11: (g :?12: (_ :?13: T) -> T) -> (z :?14: T) -> (h :?15: (_ :?16: T) -> T) -> (w :?17: T) -> T
f = \g :?18: (_ :?19: T) -> T. \z :?20: T. \h :?21: (_ :?22: T) -> T. \w :?23: T. (Op -?27- (g -?29- z) -?25- (h -?31- w))

main :!R: T
main = (f -?39- id -?37- B -?35- const_A -?33- B)

### Inferred definitions ###

A :?2: T

B :?3: T

Op :?4: (x :!R: T) -> (y :!R: T) -> T

T :?1: *

const_A :?8: (_ :?9: T) -> T
  [] -> [?2,!R]
  [?9] -> [?10]
  [?10] -> [?9]

f :?11: (g :?12: (_ :?13: T) -> T) -> (z :?14: T) -> (h :?15: (_ :?16: T) -> T) -> (w :?17: T) -> T
  [] -> [?1_14,?1_16,?4,?12,?15,?18,?21,?24,?25,?26,?27,!R]
  [?13] -> [?19]
  [?14] -> [?20]
  [?16] -> [?22]
  [?17] -> [?23]
  [?19] -> [?13,?28]
  [?19_14] -> [?1_15,?19,?20,?29]
  [?20] -> [?14]
  [?22] -> [?16,?30]
  [?22_16] -> [?1_17,?22,?23,?31]
  [?23] -> [?17]

id :?5: (_ :?6: T) -> T
  [] -> [?1_2,?6,?7,!R]

main :!R: T
  [] -> [?1_26,?1_27,?2_30,?3,?4_26,?5,?6,?6_27,?7_27,?8,?11,?12,?12_26,?13,?13_26,?14,?14_26,?15,?15_26,?18_26,?19_26,?20_26,?21_26,?24_26,?25_26,?26_26,?27_26,?28_26,?29_26,?34,?35,?36,?37,?38,?39,!R]
  [?9_30] -> [?9,?10_30,?16_26]
  [?10_30] -> [?9_30]
  [?16_26] -> [?9_30,?16,?22_26]
  [?17] -> [?32]
  [?17_26] -> [?17,?23_26,?33]
  [?22_26] -> [?16_26,?22_26,?23_26,?30_26,?31_26]
  [?23_26] -> [?17_26]


### Constraints ###

[] -> [?1_2,?1_14,?1_16,?1_26,?1_27,?2,?2_30,?3,?4,?4_26,?5,?6,?6_27,?7,?7_27,?8,?11,?12,?12_26,?13,?13_26,?14,?14_26,?15,?15_26,?18,?18_26,?19_26,?20_26,?21,?21_26,?24,?24_26,?25,?25_26,?26,?26_26,?27,?27_26,?28_26,?29_26,?34,?35,?36,?37,?38,?39,!R]
[?9] -> [?10]
[?9_30] -> [?9,?10_30,?16_26]
[?10] -> [?9]
[?10_30] -> [?9_30]
[?13] -> [?19]
[?14] -> [?20]
[?16] -> [?22]
[?16_26] -> [?9_30,?16,?22_26]
[?17] -> [?23,?32]
[?17_26] -> [?17,?23_26,?33]
[?19] -> [?13,?28]
[?19_14] -> [?1_15,?19,?20,?29]
[?20] -> [?14]
[?22] -> [?16,?30]
[?22_16] -> [?1_17,?22,?23,?31]
[?22_26] -> [?16_26,?22_26,?23_26,?30_26,?31_26]
[?23] -> [?17]
[?23_26] -> [?17_26]

### Solution ###

[?1_2,?1_14,?1_16,?1_26,?1_27,?2,?2_30,?3,?4,?4_26,?5,?6,?6_27,?7,?7_27,?8,?11,?12,?12_26,?13,?13_26,?14,?14_26,?15,?15_26,?18,?18_26,?19,?19_26,?20,?20_26,?21,?21_26,?24,?24_26,?25,?25_26,?26,?26_26,?27,?27_26,?28,?28_26,?29_26,?34,?35,?36,?37,?38,?39,!R]

### Annotated ###

T :I: *
T = (axiom)

A :R: T
A = (axiom)

B :R: T
B = (axiom)

Op :R: (x :R: T) -> (y :R: T) -> T
Op = (axiom)

id :R: (_ :R: T) -> T
id = \t :R: T. t

const_A :R: (_ :I: T) -> T
const_A = \_ :I: T. A

f :R: (g :R: (_ :R: T) -> T) -> (z :R: T) -> (h :R: (_ :I: T) -> T) -> (w :I: T) -> T
f = \g :R: (_ :R: T) -> T. \z :R: T. \h :R: (_ :I: T) -> T. \w :I: T. (Op -R- (g -I- z) -R- (h -I- w))

main :R: T
main = (f -R- id -R- B -R- const_A -I- B)

### Pruned ###

A = (axiom)

B = (axiom)

Op = (axiom)

id = \t. t

const_A = A

f = \g. \z. \h. (Op (g ____) h)

main = (f id B const_A)

