-- vim: ft=agda

### Desugared ###

T : *

A : T

B : T

Op : (x  -R-  T) -> (y  -R-  T) -> T

id : (_ : T) -> T
id = \t : T. t

const_A : (_ : T) -> T
const_A = \_ : T. A

f : (g : (_ : T) -> T) -> (z : T) -> (h : (_ : T) -> T) -> (w : T) -> T
f = \g : (_ : T) -> T. \z : T. \h : (_ : T) -> T. \w : T. (Op (g z) (h w))

main  -R-  T
main = (f id B const_A B)

### Metaified ###

T :?1: *

A :?2: T

B :?3: T

Op :?4: (x :!R: T) -> (y :!R: T) -> T

id :?5: (_ :?6: T) -> T
id = \t :?7: T. t

const_A :?8: (_ :?9: T) -> T
const_A = \_ :?10: T. A

f :?11: (g :?12: (_ :?13: T) -> T) -> (z :?14: T) -> (h :?15: (_ :?16: T) -> T) -> (w :?17: T) -> T
f = \g :?18: (_ :?19: T) -> T. \z :?20: T. \h :?21: (_ :?22: T) -> T. \w :?23: T. (Op -?25- (g -?26- z) -?24- (h -?27- w))

main :!R: T
main = (f -?31- id -?30- B -?29- const_A -?28- B)

### Inferred definitions ###

A :?2: T
B :?3: T
Op :?4: (x :!R: T) -> (y :!R: T) -> T
T :?1: *
const_A :?8: (_ :?9: T) -> T
  [] -> [(?2,R),(!N,N),(!R,R)]
  [?9] -> [(?10,R)]
  [?10] -> [(?9,R)]

f :?11: (g :?12: (_ :?13: T) -> T) -> (z :?14: T) -> (h :?15: (_ :?16: T) -> T) -> (w :?17: T) -> T
  [] -> [(?4,R),(?12,R),(?15,R),(?18,R),(?21,R),(?24,R),(?25,R),(!N,N),(!R,R)]
  [?13] -> [(?19,R)]
  [?14] -> [(?20,R)]
  [?16] -> [(?22,R)]
  [?17] -> [(?23,R)]
  [?19] -> [(?13,R),(?20,R),(?26,R)]
  [?20] -> [(?14,R)]
  [?22] -> [(?16,R),(?23,R),(?27,R)]
  [?23] -> [(?17,R)]

id :?5: (_ :?6: T) -> T
  [] -> [(?6,R),(?7,R),(!N,N),(!R,R)]

main :!R: T
  [] -> [(?2_3,R),(?3,R),(?4_1,R),(?5,R),(?6,R),(?6_2,R),(?7_2,R),(?8,R),(?11,R),(?12,R),(?12_1,R),(?13,R),(?13_1,R),(?14,R),(?14_1,R),(?15,R),(?15_1,R),(?18_1,R),(?19_1,R),(?20_1,R),(?21_1,R),(?24_1,R),(?25_1,R),(?26_1,R),(?29,R),(?30,R),(?31,R),(!N,N),(!R,R)]
  [?9] -> [(?9_3,N)]
  [?9_3] -> [(?9,R),(?10_3,R),(?16_1,R)]
  [?10_3] -> [(?9_3,R)]
  [?16] -> [(?16_1,N)]
  [?16_1] -> [(?9_3,R),(?16,R),(?22_1,R)]
  [?17] -> [(?17_1,N)]
  [?17_1] -> [(?3,R),(?17,R),(?23_1,R),(?28,R)]
  [?22_1] -> [(?16_1,R),(?23_1,R),(?27_1,R)]
  [?23_1] -> [(?17_1,R)]


### Constraints ###

[] -> [(?2,R),(?2_3,R),(?3,R),(?4,R),(?4_1,R),(?5,R),(?6,R),(?6_2,R),(?7,R),(?7_2,R),(?8,R),(?11,R),(?12,R),(?12_1,R),(?13,R),(?13_1,R),(?14,R),(?14_1,R),(?15,R),(?15_1,R),(?18,R),(?18_1,R),(?19_1,R),(?20_1,R),(?21,R),(?21_1,R),(?24,R),(?24_1,R),(?25,R),(?25_1,R),(?26_1,R),(?29,R),(?30,R),(?31,R),(!N,N),(!R,R)]
[?9] -> [(?9_3,N),(?10,R)]
[?9_3] -> [(?9,R),(?10_3,R),(?16_1,R)]
[?10] -> [(?9,R)]
[?10_3] -> [(?9_3,R)]
[?13] -> [(?19,R)]
[?14] -> [(?20,R)]
[?16] -> [(?16_1,N),(?22,R)]
[?16_1] -> [(?9_3,R),(?16,R),(?22_1,R)]
[?17] -> [(?17_1,N),(?23,R)]
[?17_1] -> [(?3,R),(?17,R),(?23_1,R),(?28,R)]
[?19] -> [(?13,R),(?20,R),(?26,R)]
[?20] -> [(?14,R)]
[?22] -> [(?16,R),(?23,R),(?27,R)]
[?22_1] -> [(?16_1,R),(?23_1,R),(?27_1,R)]
[?23] -> [(?17,R)]
[?23_1] -> [(?17_1,R)]

### Solution ###

[(?2,R),(?2_3,R),(?3,R),(?4,R),(?4_1,R),(?5,R),(?6,R),(?6_2,R),(?7,R),(?7_2,R),(?8,R),(?11,R),(?12,R),(?12_1,R),(?13,R),(?13_1,R),(?14,R),(?14_1,R),(?15,R),(?15_1,R),(?18,R),(?18_1,R),(?19,R),(?19_1,R),(?20,R),(?20_1,R),(?21,R),(?21_1,R),(?24,R),(?24_1,R),(?25,R),(?25_1,R),(?26,R),(?26_1,R),(?29,R),(?30,R),(?31,R),(!N,N),(!R,R)]

### Annotated ###

T :E: *

A :R: T

B :R: T

Op :R: (x :R: T) -> (y :R: T) -> T

id :R: (_ :R: T) -> T
id = \t :R: T. t

const_A :R: (_ :E: T) -> T
const_A = \_ :E: T. A

f :R: (g :R: (_ :R: T) -> T) -> (z :R: T) -> (h :R: (_ :E: T) -> T) -> (w :E: T) -> T
f = \g :R: (_ :R: T) -> T. \z :R: T. \h :R: (_ :E: T) -> T. \w :E: T. (Op -R- (g -R- z) -R- (h -E- w))

main :R: T
main = (f -R- id -R- B -R- const_A -E- B)

### Pruned ###

id = \t. t

const_A = A

f = \g. \z. \h. (Op (g z) h)

main = (f id B const_A)

